<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lorenzo Marquesini, Agustín Orue, Juan Cruz Chierasco, Marco Di Sario">
<meta name="dcterms.date" content="2024-11-28">

<title>Análisis de Modelos Lineales y Algoritmos de Optimización en Datos de Propiedades</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="finalv2_files/libs/clipboard/clipboard.min.js"></script>
<script src="finalv2_files/libs/quarto-html/quarto.js"></script>
<script src="finalv2_files/libs/quarto-html/popper.min.js"></script>
<script src="finalv2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="finalv2_files/libs/quarto-html/anchor.min.js"></script>
<link href="finalv2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="finalv2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="finalv2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="finalv2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="finalv2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>
<link href="finalv2_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="finalv2_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="finalv2_files/libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="finalv2_files/libs/typedarray-0.1/typedarray.min.js"></script>

<script src="finalv2_files/libs/jquery-3.5.1/jquery.min.js"></script>

<link href="finalv2_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="finalv2_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="finalv2_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="finalv2_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#resumen" id="toc-resumen" class="nav-link active" data-scroll-target="#resumen"><span class="header-section-number">1</span> Resumen</a></li>
  <li><a href="#introduccion" id="toc-introduccion" class="nav-link" data-scroll-target="#introduccion"><span class="header-section-number">2</span> Introduccion</a></li>
  <li><a href="#teoria" id="toc-teoria" class="nav-link" data-scroll-target="#teoria"><span class="header-section-number">3</span> Teoria</a>
  <ul class="collapse">
  <li><a href="#representación---el-modelo-en-si-mismo" id="toc-representación---el-modelo-en-si-mismo" class="nav-link" data-scroll-target="#representación---el-modelo-en-si-mismo"><span class="header-section-number">3.1</span> Representación - “El Modelo en si mismo”</a></li>
  <li><a href="#evaluación---medida-de-falta-de-ajuste" id="toc-evaluación---medida-de-falta-de-ajuste" class="nav-link" data-scroll-target="#evaluación---medida-de-falta-de-ajuste"><span class="header-section-number">3.2</span> Evaluación - “Medida de falta de ajuste”</a></li>
  <li><a href="#optimización---etapa-de-entrenamiento" id="toc-optimización---etapa-de-entrenamiento" class="nav-link" data-scroll-target="#optimización---etapa-de-entrenamiento"><span class="header-section-number">3.3</span> Optimización - “Etapa de entrenamiento”</a></li>
  </ul></li>
  <li><a href="#resultados" id="toc-resultados" class="nav-link" data-scroll-target="#resultados"><span class="header-section-number">4</span> Resultados</a></li>
  <li><a href="#conclusiones" id="toc-conclusiones" class="nav-link" data-scroll-target="#conclusiones"><span class="header-section-number">5</span> Conclusiones</a></li>
  <li><a href="#apendice" id="toc-apendice" class="nav-link" data-scroll-target="#apendice"><span class="header-section-number">6</span> Apendice</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Análisis de Modelos Lineales y Algoritmos de Optimización en Datos de Propiedades</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lorenzo Marquesini, Agustín Orue, Juan Cruz Chierasco, Marco Di Sario </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 28, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="resumen" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="resumen"><span class="header-section-number">1</span> Resumen</h2>
<p>En este trabajo analizamos el uso de modelos lineales y algoritmos de optimización aplicados a un conjunto de datos de propiedades inmobiliarias del barrio de Boedo, en la Ciudad de Buenos Aires. Se busca entender cómo la superficie cubierta (Sup) influye en el precio (Precio) de venta de las casas. Utilizaremos métodos de optimización como Luus-Jaakola y gradiente descendente para ajustar un modelo lineal a los datos.</p>
</section>
<section id="introduccion" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="introduccion"><span class="header-section-number">2</span> Introduccion</h2>
<p>Utilizaremos un subconjunto del dataset real de publicaciones digitales de inmuebles, provisto en forma libre por Properati <a href="https://www.properati.com.ar/" title="properati.com.ar">[1]</a>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">as.data.frame</span>(data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Sup Fondo Precio
1 140     0 215000
2  35     0  90000
3 132    18 239000
4 212     0 394900
5 225    68 480000
6  60    46 175000</code></pre>
</div>
</div>
<p>En este caso contamos con 68 casas del barrio de Boedo, con precios en dólares que van desde los u$s 90000 hasta los u$s 600000. Se plantea un resumen de estos datos en el próximo gráfico.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalv2_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Puede observarse que tanto la superficie cubierta (Sup) como el fondo (Fondo) están positivamente correlacionados con el precio (Precio). Asimismo, también se aprecia una correlación positiva entre Sup y Fondo.</p>
</section>
<section id="teoria" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="teoria"><span class="header-section-number">3</span> Teoria</h2>
<blockquote class="blockquote">
<p>Un Modelo es una explicitación simplifcada de algunas relaciones potencialmente existentes entre las variables disponibles</p>
</blockquote>
<p>Dividimos el trabajo con el modelo en 3 etapas principales:</p>
<ul>
<li><p>Representación</p></li>
<li><p>Evaluación</p></li>
<li><p>Optimización</p></li>
</ul>
<section id="representación---el-modelo-en-si-mismo" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="representación---el-modelo-en-si-mismo"><span class="header-section-number">3.1</span> Representación - “El Modelo en si mismo”</h3>
<p>Proponemos un modelo lineal sencillo que relaciona el precio con la superficie cubierta:</p>
<p><span class="math display">\[
h_0 = \mu + \alpha * Sup
\]</span></p>
<p>Donde: - <span class="math inline">\(h_0\)</span> es la predicción del precio. - <span class="math inline">\(\mu\)</span> es el término independiente. - <span class="math inline">\(\alpha\)</span> es el coeficiente que multiplica a la superficie cubierta (Sup).</p>
<p>El modelo recién planteado puede pensarse como una función, que dados los parámetros θ = (µ, α), asigna un precio a una combinación cualquiera de valores de superficie. Entonces</p>
<p><span class="math display">\[
Precio^{m2} = F_{\mu, \alpha}(Sup)
\]</span></p>
</section>
<section id="evaluación---medida-de-falta-de-ajuste" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="evaluación---medida-de-falta-de-ajuste"><span class="header-section-number">3.2</span> Evaluación - “Medida de falta de ajuste”</h3>
<p>Utilizamos el error cuadrático medio (MSE) como función de pérdida para evaluar el ajuste del modelo:</p>
<p><span class="math display">\[
\frac{1}{68} \sum_{i=1}^{68} (Precio_i - (\mu + \alpha * Sup))^2
\]</span></p>
<p>Donde: - <span class="math inline">\(n\)</span> es el número de observaciones (en este caso, 68). - <span class="math inline">\(Precio_i\)</span> es el precio real de la observación <span class="math inline">\(i\)</span>. - <span class="math inline">\(Sup_i\)</span> es la superficie cubierta de la observación <span class="math inline">\(i\)</span>.</p>
<section id="funciones-de-perdida-alternativas" class="level4" data-number="3.2.1">
<h4 data-number="3.2.1" class="anchored" data-anchor-id="funciones-de-perdida-alternativas"><span class="header-section-number">3.2.1</span> Funciones de perdida Alternativas</h4>
<p>Además del MSE, existen otras funciones de pérdida que pueden ser utilizadas, cada una con sus pros y contras:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Función de Pérdida</th>
<th>Pros</th>
<th>Contras</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Error Absoluto Medio (MAE)</td>
<td>Menos sensible a valores atípicos</td>
<td>Puede ser menos eficiente en términos estadísticos</td>
</tr>
<tr class="even">
<td>Error Cuadrático Medio (MSE)</td>
<td>Penaliza más los errores grandes</td>
<td>Sensible a valores atípicos</td>
</tr>
<tr class="odd">
<td>Error Logarítmico</td>
<td>Útil para datos con crecimiento exponencial</td>
<td>No está definido para valores cero o negativos</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="optimización---etapa-de-entrenamiento" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="optimización---etapa-de-entrenamiento"><span class="header-section-number">3.3</span> Optimización - “Etapa de entrenamiento”</h3>
<p>La tarea de optimización consiste en, dadas la representación y la evaluación elegidas, definir un procedimiento efectivo que pueda hallar la determinación óptima de los parámetros del modelo, es decir, la determinación de parámetros que produzcan la menor falta de ajuste posible.</p>
<p>En este caso particular, el problema de optimización planteado puede resolverse analíticamente mediante mínimos cuadrados ordinarios (OLS). Sin embargo, utilizaremos métodos numéricos para ilustrar su aplicación en casos donde la solución analítica no es viable.</p>
<p>En modelos más complejos o no lineales, la función de pérdida puede no ser convexa o no tener una solución cerrada, lo que hace necesario el uso de métodos numéricos de optimización, no se puede resolver analíticamente.</p>
<p>Vamos a aplicar dos mecanismos básicos de optimización:</p>
<ol type="1">
<li>Luus-Jaakola - Optimización Aleatoria</li>
<li>Gradiente Descendente</li>
</ol>
<section id="luus-jaakola---optimización-aleatoria" class="level4" data-number="3.3.1">
<h4 data-number="3.3.1" class="anchored" data-anchor-id="luus-jaakola---optimización-aleatoria"><span class="header-section-number">3.3.1</span> Luus-Jaakola - Optimización Aleatoria</h4>
<p>El método Luus-Jaakola es un algoritmo de optimización estocástica que no requiere información sobre el gradiente de la función objetivo. Consiste en:</p>
<ol type="1">
<li>Inicializar los parámetros con valores arbitrarios.</li>
<li>En cada iteración, generar nuevos candidatos alrededor de los mejores parámetros actuales, dentro de una región de búsqueda que se va reduciendo.</li>
<li>Si un nuevo candidato mejora la función objetivo, se actualizan los parámetros.</li>
<li>Repetir hasta convergencia o hasta alcanzar un número máximo de iteraciones.</li>
</ol>
<p>Implementamos el método Luus-Jaakola de la siguiente manera:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estandarizar variables</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mean_sup <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Sup)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>sd_sup <span class="ot">&lt;-</span> <span class="fu">sd</span>(data<span class="sc">$</span>Sup)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>mean_precio <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Precio)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>sd_precio <span class="ot">&lt;-</span> <span class="fu">sd</span>(data<span class="sc">$</span>Precio)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Sup_scaled <span class="ot">&lt;-</span> (data<span class="sc">$</span>Sup <span class="sc">-</span> mean_sup) <span class="sc">/</span> sd_sup</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Precio_scaled <span class="ot">&lt;-</span> (data<span class="sc">$</span>Precio <span class="sc">-</span> mean_precio) <span class="sc">/</span> sd_precio</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Inicialización</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>mu_lj <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>alpha_lj <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>best_loss <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)  <span class="co"># Tamaño inicial de la región de búsqueda</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>n_iter <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Vectores para almacenar la evolución</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>mu_history <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>alpha_history <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>loss_history <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_iter) {</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generar nuevos candidatos</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  mu_candidate <span class="ot">&lt;-</span> mu_lj <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span>delta[<span class="dv">1</span>], delta[<span class="dv">1</span>])</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  alpha_candidate <span class="ot">&lt;-</span> alpha_lj <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span>delta[<span class="dv">2</span>], delta[<span class="dv">2</span>])</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcular pérdida en escala estandarizada</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  preds_scaled <span class="ot">&lt;-</span> mu_candidate <span class="sc">+</span> alpha_candidate <span class="sc">*</span> data<span class="sc">$</span>Sup_scaled</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  loss <span class="ot">&lt;-</span> <span class="fu">mean</span>((data<span class="sc">$</span>Precio_scaled <span class="sc">-</span> preds_scaled)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Actualizar si mejora</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (loss <span class="sc">&lt;</span> best_loss) {</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    mu_lj <span class="ot">&lt;-</span> mu_candidate</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    alpha_lj <span class="ot">&lt;-</span> alpha_candidate</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    best_loss <span class="ot">&lt;-</span> loss</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reducir región de búsqueda</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    delta <span class="ot">&lt;-</span> delta <span class="sc">*</span> <span class="fl">0.95</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Aumentar región de búsqueda ligeramente</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    delta <span class="ot">&lt;-</span> delta <span class="sc">*</span> <span class="fl">1.05</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Almacenar historia</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  mu_history[i] <span class="ot">&lt;-</span> mu_lj</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  alpha_history[i] <span class="ot">&lt;-</span> alpha_lj</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  loss_history[i] <span class="ot">&lt;-</span> best_loss</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir parámetros a escala original</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>alpha_lj <span class="ot">&lt;-</span> alpha_lj <span class="sc">*</span> (sd_precio <span class="sc">/</span> sd_sup)</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>mu_lj <span class="ot">&lt;-</span> (mu_lj <span class="sc">*</span> sd_precio <span class="sc">+</span> mean_precio) <span class="sc">-</span> alpha_lj <span class="sc">*</span> mean_sup</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Almacenar historia de parámetros en escala original para visualización</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>alpha_history <span class="ot">&lt;-</span> alpha_history <span class="sc">*</span> (sd_precio <span class="sc">/</span> sd_sup)</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>mu_history <span class="ot">&lt;-</span> (mu_history <span class="sc">*</span> sd_precio <span class="sc">+</span> mean_precio) <span class="sc">-</span> alpha_history <span class="sc">*</span> mean_sup</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Empecemos viendo la evolución de la cantidad de iteraciones en función de la cantidad de actualizaciones (modificación del óptimo hasta ese momento) a lo largo del proceso.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>n_iter, <span class="at">y =</span> loss_history, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Pérdida'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Evolución de la Pérdida con Luus-Jaakola'</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Iteración'</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Pérdida'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-88fdd2a34d502a66744b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-88fdd2a34d502a66744b">{"x":{"visdat":{"672caef5c4e":["function () ","plotlyVisDat"]},"cur_data":"672caef5c4e","attrs":{"672caef5c4e":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0.70599124222108234,0.70599124222108234,0.70599124222108234,0.70599124222108234,0.65351515956322381,0.65351515956322381,0.52093112728739721,0.52093112728739721,0.52093112728739721,0.52093112728739721,0.52093112728739721,0.52093112728739721,0.52093112728739721,0.52093112728739721,0.52093112728739721],"mode":"lines","name":"Pérdida","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Evolución de la Pérdida con Luus-Jaakola","xaxis":{"domain":[0,1],"automargin":true,"title":"Iteración"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Pérdida"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0.70599124222108234,0.70599124222108234,0.70599124222108234,0.70599124222108234,0.65351515956322381,0.65351515956322381,0.52093112728739721,0.52093112728739721,0.52093112728739721,0.52093112728739721,0.52093112728739721,0.52093112728739721,0.52093112728739721,0.52093112728739721,0.52093112728739721],"mode":"lines","name":"Pérdida","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>El siguiente gráfico muestra la evolución de los mejores parámetros obtenidos a lo largo del proceso</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Evolución de Mu</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Evolución de Alpha</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_params <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  Iteración <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span>n_iter,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mu =</span> mu_history,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Alpha =</span> alpha_history</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de la evolución de Mu</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>plot_mu <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(df_params, <span class="at">x =</span> <span class="sc">~</span>Iteración, <span class="at">y =</span> <span class="sc">~</span>Mu, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Mu'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Evolución de Mu con Luus-Jaakola'</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Iteración'</span>),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Mu'</span>))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de la evolución de Alpha</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>plot_alpha <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(df_params, <span class="at">x =</span> <span class="sc">~</span>Iteración, <span class="at">y =</span> <span class="sc">~</span>Alpha, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">color=</span> <span class="st">"orange"</span>, <span class="at">name =</span> <span class="st">'Alpha'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Evolución de Alpha con Luus-Jaakola'</span>,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Iteración'</span>),</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Alpha'</span>))</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los gráficos por separado</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>plot_mu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8e1fe96c0688a849169a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8e1fe96c0688a849169a">{"x":{"visdat":{"672c7b8b6df6":["function () ","plotlyVisDat"]},"cur_data":"672c7b8b6df6","attrs":{"672c7b8b6df6":{"x":{},"y":{},"mode":"lines","name":"Mu","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Evolución de Mu con Luus-Jaakola","xaxis":{"domain":[0,1],"automargin":true,"title":"Iteración"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Mu"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[94598.020673516323,94598.020673516323,94598.020673516323,94598.020673516323,142080.77071448698,142080.77071448698,137722.89976188247,137722.89976188247,137722.89976188247,137722.89976188247,137722.89976188247,137722.89976188247,137722.89976188247,137722.89976188247,137722.89976188247],"mode":"lines","name":"Mu","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>plot_alpha</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-bb3486349adfa5d821dc" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-bb3486349adfa5d821dc">{"x":{"visdat":{"672c762f5e03":["function () ","plotlyVisDat"]},"cur_data":"672c762f5e03","attrs":{"672c762f5e03":{"x":{},"y":{},"mode":"lines","name":"Alpha","color":"orange","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Evolución de Alpha con Luus-Jaakola","xaxis":{"domain":[0,1],"automargin":true,"title":"Iteración"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Alpha"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[1043.6353547839485,1043.6353547839485,1043.6353547839485,1043.6353547839485,870.92031431224507,870.92031431224507,1159.3481674929264,1159.3481674929264,1159.3481674929264,1159.3481674929264,1159.3481674929264,1159.3481674929264,1159.3481674929264,1159.3481674929264,1159.3481674929264],"mode":"lines","name":"Alpha","type":"scatter","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
<p>Se ve claramente que la evolución de cada uno de los dos parámetros converge a un valor final, a los que podemos considerar como las estimaciones. Estos valores finales son:</p>
<ul>
<li><span class="math inline">\(\mu =\)</span> 137722.8997619</li>
<li><span class="math inline">\(\alpha =\)</span> 1159.3481675</li>
</ul>
</section>
<section id="gradiente-descendente" class="level4" data-number="3.3.2">
<h4 data-number="3.3.2" class="anchored" data-anchor-id="gradiente-descendente"><span class="header-section-number">3.3.2</span> Gradiente Descendente</h4>
<p>El método del gradiente descendente consiste en actualizar los parámetros en la dirección opuesta al gradiente de la función de pérdida. El algoritmo es el siguiente:</p>
<ol type="1">
<li><p>Inicializar los parámetros con valores aleatorios.</p></li>
<li><p>Calcular el gradiente de la función de pérdida con respecto a los parámetros.</p></li>
<li><p>Actualizar los parámetros en la dirección opuesta al gradiente. <span class="math display">\[
\theta_{t+1} = \theta_t - \lambda \nabla L
\]</span> Donde <span class="math inline">\(\lambda\)</span> es la tasa de aprendizaje (learning rate) y <span class="math inline">\(\nabla L(\theta_t)\)</span> es el gradiente de la función de pérdida <span class="math inline">\(L\)</span> con respecto a los parámetros <span class="math inline">\(\theta\)</span> en el paso <span class="math inline">\(t\)</span>.</p></li>
<li><p>Repetir hasta convergencia.</p></li>
</ol>
<blockquote class="blockquote">
<p>Convergencia: La convergencia se produce cuando un modelo ha alcanzado un estado en el que ya no mejora significativamente su rendimiento con más iteraciones o entrenamiento.</p>
</blockquote>
<p>Existen diferentes variantes del gradiente descendente: * <strong>Gradiente Descendente por Lotes (Batch Gradient Descent)</strong>: Utiliza todo el conjunto de datos para calcular el gradiente en cada paso. Es estable pero puede ser lento en conjuntos de datos grandes.</p>
<ul>
<li><p><strong>Gradiente Descendente Estocástico (Stochastic Gradient Descent, SGD)</strong>: Actualiza los parámetros usando una sola muestra a la vez. Es más rápido pero introduce ruido en la estimación del gradiente, lo que puede dificultar la convergencia.</p></li>
<li><p><strong>Gradiente Descendente Mini-Batch</strong>: Compromiso entre los dos anteriores. Usa un subconjunto (mini-batch) de muestras para calcular el gradiente en cada paso. Balancea eficiencia computacional y estabilidad en la convergencia.</p></li>
</ul>
<p>En este caso, implementaremos el gradiente descendente por lotes, utilizando todo el conjunto de datos en cada iteración.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estandarizar variables</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>mean_sup <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Sup)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>sd_sup <span class="ot">&lt;-</span> <span class="fu">sd</span>(data<span class="sc">$</span>Sup)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>mean_precio <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Precio)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>sd_precio <span class="ot">&lt;-</span> <span class="fu">sd</span>(data<span class="sc">$</span>Precio)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Sup_scaled <span class="ot">&lt;-</span> (data<span class="sc">$</span>Sup <span class="sc">-</span> mean_sup) <span class="sc">/</span> sd_sup</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Precio_scaled <span class="ot">&lt;-</span> (data<span class="sc">$</span>Precio <span class="sc">-</span> mean_precio) <span class="sc">/</span> sd_precio</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Inicialización de parámetros</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>mu_gd <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>alpha_gd <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>learning_rate <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>n_iter_gd <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Vectores para almacenar la evolución</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>mu_history_gd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter_gd)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>alpha_history_gd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter_gd)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>loss_history_gd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter_gd)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_iter_gd) {</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predicciones usando variables escaladas</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  preds_scaled <span class="ot">&lt;-</span> mu_gd <span class="sc">+</span> alpha_gd <span class="sc">*</span> data<span class="sc">$</span>Sup_scaled</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  errors <span class="ot">&lt;-</span> preds_scaled <span class="sc">-</span> data<span class="sc">$</span>Precio_scaled</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcular gradientes</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  mu_grad <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">/</span> <span class="fu">nrow</span>(data)) <span class="sc">*</span> <span class="fu">sum</span>(errors)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  alpha_grad <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">/</span> <span class="fu">nrow</span>(data)) <span class="sc">*</span> <span class="fu">sum</span>(errors <span class="sc">*</span> data<span class="sc">$</span>Sup_scaled)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Actualizar parámetros</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  mu_gd <span class="ot">&lt;-</span> mu_gd <span class="sc">-</span> learning_rate <span class="sc">*</span> mu_grad</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  alpha_gd <span class="ot">&lt;-</span> alpha_gd <span class="sc">-</span> learning_rate <span class="sc">*</span> alpha_grad</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcular pérdida</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  loss <span class="ot">&lt;-</span> <span class="fu">mean</span>(errors<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Almacenar historia</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  mu_history_gd[i] <span class="ot">&lt;-</span> mu_gd</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>  alpha_history_gd[i] <span class="ot">&lt;-</span> alpha_gd</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  loss_history_gd[i] <span class="ot">&lt;-</span> loss</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir parámetros a escala original</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>alpha_gd <span class="ot">&lt;-</span> alpha_gd <span class="sc">*</span> (sd_precio <span class="sc">/</span> sd_sup)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>mu_gd <span class="ot">&lt;-</span> (mu_gd <span class="sc">*</span> sd_precio <span class="sc">+</span> mean_precio) <span class="sc">-</span> alpha_gd <span class="sc">*</span> mean_sup</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Almacenar historia de parámetros en escala original para visualización</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>alpha_history_gd <span class="ot">&lt;-</span> alpha_history_gd <span class="sc">*</span> (sd_precio <span class="sc">/</span> sd_sup)</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>intercept_history_gd <span class="ot">&lt;-</span> (mu_history_gd <span class="sc">*</span> sd_precio <span class="sc">+</span> mean_precio) <span class="sc">-</span> alpha_history_gd <span class="sc">*</span> mean_sup</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Visualizamos la evolución de la pérdida:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadir puntos a cada iteración</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n_iter_gd</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> iterations, <span class="at">y =</span> loss_history_gd, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, <span class="at">name =</span> <span class="st">'Pérdida'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Evolución de la Pérdida con Gradiente Descendente'</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Iteración'</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Pérdida'</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> iterations[<span class="fu">which.min</span>(loss_history_gd)],</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">min</span>(loss_history_gd),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">text =</span> <span class="fu">paste</span>(<span class="st">'Mínima pérdida:'</span>, <span class="fu">round</span>(<span class="fu">min</span>(loss_history_gd), <span class="dv">2</span>)),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">showarrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">arrowhead =</span> <span class="dv">7</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">ax =</span> <span class="sc">-</span><span class="dv">40</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">ay =</span> <span class="sc">-</span><span class="dv">40</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>         ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-44474b3e8cd160f85a98" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-44474b3e8cd160f85a98">{"x":{"visdat":{"672c386923c4":["function () ","plotlyVisDat"]},"cur_data":"672c386923c4","attrs":{"672c386923c4":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1000],"y":[0.98529411764705888,0.96683076946248303,0.94908792469165204,0.93203746681073596,0.91565237649946662,0.89990668882447822,0.88477545209349961,0.87023468831519812,0.85626135520201707,0.84283330965579284,0.82992927267828853,0.81752879565104031,0.80561222793107901,0.79416068571118015,0.78315602209529167,0.77258079834172377,0.76241825622852755,0.75265229149727131,0.74326742833313286,0.73424879484086614,0.7255820994777803,0.71725360840638441,0.70925012373081109,0.7015589625825287,0.69416793702220159,0.68706533472584885,0.68023990042469595,0.67368081806930669,0.66737769368973243,0.6613205389245177,0.65549975519245929,0.64990611848204072,0.64453076473443105,0.639365175796894,0.6344011659243397,0.62963086880763475,0.62504672510811088,0.62064147047852092,0.61640812405145773,0.61233997737699464,0.6084305837920182,0.60467374820440445,0.60106351727585317,0.59759416998782178,0.59426020857560813,0.59105634981621658,0.58797751665620279,0.5850188301662278,0.58217560180957273,0.57944332601236404,0.57681767302373266,0.57429448205459566,0.57186975468418511,0.56953964852387784,0.56730047112828352,0.56514867414394399,0.56308084768636923,0.5610937149365024,0.55918412694804775,0.5573490576574357,0.55558559908851546,0.55389095674437749,0.55226244517900314,0.55069748374172289,0.54919359248774124,0.54774838824824712,0.54635958085388114,0.54502496950557755,0.54374243928702692,0.54250995781323585,0.54132557200987064,0.54018740501828244,0.53909365322130853,0.53804258338513788,0.53703252991270989,0.53606189220429568,0.53512913212107882,0.53423277154771498,0.53337139005000933,0.53254362262400035,0.53174815753288007,0.53098373422832734,0.5302491413529562,0.52954321482071676,0.52886483597220435,0.52821292980195589,0.52758646325492264,0.52698444358942031,0.52640591680396343,0.52584996612548873,0.52531571055657433,0.52480230347935097,0.52430893131389356,0.52383481222896644,0.52337919490308105,0.52294135733389946,0.52252060569410119,0.52211627323189647,0.52172771921444594,0.52135432791251135,0.52099550762472979,0.52065068973996209,0.5203193278362338,0.52000089681483708,0.5196948920682235,0.51940082868036852,0.51911824065834045,0.51884668019385605,0.51858571695365319,0.5183349373975551,0.51809394412314647,0.51786235523602264,0.51763980374461327,0.51742593697862271,0.51722041603016433,0.51702291521670429,0.51683312156496219,0.51665073431495301,0.51647546444338144,0.51630703420563639,0.51614517669565763,0.5159896354229786,0.51584016390627352,0.51569652528276688,0.51555849193288361,0.51542584511954892,0.51529837464156103,0.51517587850049318,0.51505816258059267,0.5149450403411715,0.5148363325210018,0.5147318668542461,0.51463147779747265,0.51453500626732462,0.51444229938842556,0.51435321025112213,0.51426759767868191,0.51418532600357447,0.51410626485248334,0.51403028893970781,0.51395727786862699,0.51388711594090997,0.51381969197317334,0.51375489912079231,0.51369263470858695,0.51363280006811629,0.51357530038132193,0.51352004453027233,0.51346694495277134,0.51341591750360149,0.51336688132118091,0.51331975869942525,0.51327447496460943,0.51323095835703381,0.5131891399173093,0.51314895337707989,0.51311033505400871,0.51307322375086306,0.5130375606585369,0.51300328926285799,0.51297035525503165,0.51293870644557948,0.51290829268163596,0.51287906576747333,0.51285097938812674,0.51282398903600124,0.51279805194034078,0.51277312699945199,0.51274917471557102,0.51272615713227243,0.51270403777432161,0.5126827815898729,0.51266235489492451,0.51264272531994015,0.51262386175855446,0.51260573431827949,0.51258831427313523,0.51257157401812803,0.51255548702550635,0.51254002780272279,0.51252517185203683,0.51251089563169439,0.51249717651862137,0.51248399277257406,0.51247132350168789,0.51245914862937092,0.51244744886248861,0.51243620566079129,0.51242540120753355,0.51241501838124059,0.51240504072857662,0.51239545243827178,0.51238623831606633,0.51237738376063258,0.51236887474043724,0.51236069777150572,0.51235283989605451,0.51234528866195728,0.51233803210301265,0.51233105871998186,0.51232435746236549,0.51231791771089319,0.51231172926069479,0.51230578230512935,0.51230006742024492,0.51229457554984448,0.51228929799113498,0.51228422638093662,0.51227935268242919,0.51227466917241726,0.51227016842909079,0.5122658433202647,0.51226168699207586,0.51225769285812284,0.51225385458902806,0.51225016610240814,0.5122466215532353,0.51224321532457462,0.51223994201868372,0.51223679644845832,0.51223377362921307,0.51223086877078206,0.51222807726992814,0.5122253947030484,0.51222281681916415,0.51222033953318447,0.51221795891943289,0.51221567120542599,0.51221347276589613,0.5122113601170456,0.51220932991102697,0.51220737893063706,0.51220550408421894,0.51220370240076296,0.51220197102519849,0.51220030721386944,0.51219870833018688,0.51219717184045033,0.51219569530983333,0.51219427639852455,0.51219291285802027,0.51219160252756113,0.51219034333070768,0.51218913327205073,0.51218797043404873,0.51218685297398914,0.51218577912106844,0.51218474717358575,0.51218375549624673,0.51218280251757187,0.51218188672740583,0.51218100667452504,0.51218016096433761,0.51217934825667333,0.51217856726366029,0.51217781674768348,0.51217709551942403,0.5121764024359744,0.51217573639902725,0.51217509635313474,0.51217448128403675,0.5121738902170524,0.51217332221553691,0.51217277637939607,0.51217225184366066,0.51217174777711572,0.51217126338098273,0.51217079788765463,0.51217035055947879,0.51216992068758838,0.51216950759077928,0.51216911061442982,0.51216872912946443,0.51216836253135567,0.51216801023916736,0.51216767169463306,0.51216734636127215,0.512167033723539,0.5121667332860067,0.5121664445725812,0.51216616712574758,0.51216590050584465,0.51216564429036826,0.51216539807330186,0.51216516146447311,0.51216493408893549,0.51216471558637422,0.51216450561053517,0.51216430382867617,0.51216410992104011,0.51216392358034768,0.51216374451131053,0.51216357243016375,0.5121634070642157,0.51216324815141645,0.51216309543994165,0.51216294868779444,0.51216280766242117,0.5121626721403435,0.51216254190680399,0.51216241675542551,0.51216229648788469,0.51216218091359744,0.5121620698494167,0.5121619631193427,0.51216186055424373,0.51216176199158803,0.51216166727518642,0.51216157625494485,0.5121614887866266,0.5121614047316233,0.51216132395673553,0.51216124633396198,0.51216117174029641,0.51216110005753235,0.51216103117207668,0.5121609649747686,0.51216090136070735,0.51216084022908581,0.51216078148303057,0.51216072502944865,0.51216067077887995,0.51216061864535523,0.51216056854626002,0.51216052040220417,0.51216047413689503,0.51216042967701747,0.51216038695211752,0.51216034589449022,0.51216030643907284,0.51216026852334184,0.51216023208721306,0.51216019707294747,0.51216016342505921,0.51216013109022729,0.51216010001721179,0.51216007015677245,0.51216004146159022,0.51216001388619281,0.51215998738688229,0.51215996192166613,0.51215993745019039,0.51215991393367588,0.51215989133485673,0.51215986961792137,0.51215984874845544,0.51215982869338805,0.51215980942093842,0.51215979090056607,0.51215977310292249,0.51215975599980423,0.51215973956410843,0.51215972376979024,0.51215970859182058,0.51215969400614758,0.51215967998965772,0.51215966652013967,0.51215965357624849,0.51215964113747259,0.51215962918410041,0.51215961769719009,0.51215960665853855,0.5121595960506532,0.51215958585672405,0.51215957606059703,0.51215956664674878,0.51215955760026122,0.51215954890679871,0.51215954055258506,0.51215953252438151,0.51215952480946625,0.51215951739561349,0.51215951027107476,0.51215950342456007,0.51215949684522,0.51215949052262832,0.51215948444676607,0.51215947860800481,0.51215947299709208,0.51215946760513653,0.51215946242359367,0.51215945744425251,0.51215945265922225,0.5121594480609204,0.51215944364206012,0.51215943939563902,0.5121594353149278,0.5121594313934601,0.51215942762502142,0.51215942400364034,0.51215942052357799,0.51215941717931956,0.51215941396556575,0.51215941087722361,0.51215940790939918,0.51215940505738944,0.51215940231667512,0.51215939968291269,0.51215939715192882,0.51215939471971272,0.51215939238241004,0.51215939013631695,0.51215938797787408,0.51215938590366117,0.51215938391039117,0.51215938199490529,0.51215938015416851,0.51215937838526349,0.51215937668538714,0.51215937505184594,0.51215937348205109,0.51215937197351513,0.5121593705238473,0.51215936913075055,0.51215936779201732,0.51215936650552596,0.512159365269238,0.51215936408119422,0.51215936293951203,0.51215936184238209,0.51215936078806612,0.51215935977489302,0.51215935880125751,0.51215935786561662,0.51215935696648762,0.51215935610244567,0.51215935527212175,0.5121593544741998,0.51215935370741561,0.51215935297055393,0.51215935226244713,0.51215935158197312,0.51215935092805354,0.51215935029965221,0.51215934969577315,0.51215934911545957,0.51215934855779188,0.51215934802188623,0.51215934750689351,0.5121593470119975,0.51215934653641415,0.51215934607938962,0.51215934564019983,0.51215934521814865,0.51215934481256742,0.5121593444228133,0.51215934404826891,0.51215934368834037,0.5121593433424575,0.51215934301007215,0.51215934269065766,0.51215934238370775,0.51215934208873626,0.51215934180527545,0.51215934153287623,0.51215934127110707,0.51215934101955296,0.51215934077781533,0.51215934054551127,0.51215934032227239,0.512159340107745,0.51215933990158935,0.5121593397034786,0.51215933951309867,0.51215933933014812,0.51215933915433698,0.51215933898538657,0.51215933882302911,0.51215933866700747,0.51215933851707429,0.5121593383729921,0.51215933823453241,0.51215933810147596,0.51215933797361179,0.51215933785073731,0.51215933773265776,0.51215933761918619,0.51215933751014264,0.51215933740535424,0.51215933730465524,0.51215933720788576,0.51215933711489248,0.51215933702552818,0.51215933693965121,0.51215933685712545,0.51215933677782011,0.51215933670160951,0.51215933662837299,0.51215933655799439,0.51215933649036216,0.51215933642536926,0.51215933636291244,0.51215933630289301,0.51215933624521581,0.51215933618978926,0.51215933613652564,0.51215933608534059,0.51215933603615293,0.51215933598888486,0.51215933594346119,0.51215933589981022,0.51215933585786266,0.51215933581755202,0.51215933577881434,0.51215933574158845,0.51215933570581529,0.51215933567143801,0.51215933563840221,0.51215933560665572,0.51215933557614801,0.5121593355468308,0.51215933551865767,0.51215933549158399,0.5121593354655668,0.51215933544056491,0.51215933541653857,0.51215933539344993,0.51215933537126224,0.5121593353499404,0.51215933532945057,0.51215933530976043,0.51215933529083868,0.51215933527265523,0.51215933525518131,0.51215933523838941,0.51215933522225265,0.51215933520674572,0.51215933519184398,0.51215933517752366,0.51215933516376211,0.51215933515053758,0.5121593351378293,0.51215933512561673,0.51215933511388079,0.51215933510260292,0.51215933509176514,0.51215933508135025,0.51215933507134181,0.51215933506172384,0.51215933505248123,0.51215933504359945,0.51215933503506406,0.51215933502686184,0.5121593350189797,0.51215933501140509,0.51215933500412614,0.51215933499713118,0.51215933499040933,0.51215933498394961,0.51215933497774213,0.51215933497177679,0.51215933496604427,0.51215933496053534,0.51215933495524146,0.51215933495015431,0.51215933494526555,0.51215933494056753,0.51215933493605292,0.51215933493171439,0.51215933492754528,0.51215933492353882,0.51215933491968868,0.51215933491598875,0.51215933491243326,0.51215933490901655,0.51215933490573307,0.51215933490257781,0.51215933489954568,0.5121593348966319,0.51215933489383181,0.51215933489114085,0.51215933488855503,0.51215933488607013,0.51215933488368215,0.51215933488138732,0.51215933487918219,0.512159334877063,0.51215933487502652,0.51215933487306953,0.51215933487118881,0.51215933486938159,0.51215933486764487,0.51215933486597587,0.51215933486437204,0.51215933486283083,0.51215933486134979,0.51215933485992648,0.51215933485855869,0.5121593348572443,0.51215933485598131,0.5121593348547675,0.51215933485360099,0.51215933485248011,0.51215933485140297,0.5121593348503678,0.51215933484937315,0.51215933484841714,0.51215933484749854,0.51215933484661569,0.51215933484576748,0.51215933484495224,0.51215933484416876,0.51215933484341603,0.51215933484269249,0.51215933484199727,0.51215933484132925,0.51215933484068721,0.51215933484007026,0.51215933483947729,0.51215933483890752,0.51215933483836007,0.51215933483783393,0.51215933483732823,0.51215933483684239,0.51215933483637543,0.51215933483592668,0.51215933483549558,0.51215933483508125,0.51215933483468301,0.51215933483430032,0.51215933483393261,0.51215933483357923,0.51215933483323961,0.5121593348329132,0.51215933483259968,0.51215933483229825,0.51215933483200871,0.51215933483173037,0.51215933483146292,0.5121593348312059,0.51215933483095899,0.51215933483072162,0.51215933483049358,0.51215933483027443,0.51215933483006371,0.51215933482986131,0.5121593348296668,0.51215933482947984,0.51215933482930032,0.51215933482912768,0.51215933482896181,0.51215933482880238,0.51215933482864928,0.51215933482850207,0.51215933482836051,0.51215933482822462,0.51215933482809395,0.51215933482796838,0.51215933482784781,0.5121593348277319,0.51215933482762044,0.51215933482751341,0.5121593348274105,0.51215933482731169,0.51215933482721665,0.51215933482712528,0.51215933482703757,0.51215933482695331,0.51215933482687226,0.51215933482679443,0.5121593348267196,0.51215933482664766,0.5121593348265786,0.51215933482651221,0.51215933482644826,0.51215933482638709,0.51215933482632814,0.51215933482627152,0.51215933482621712,0.51215933482616471,0.51215933482611453,0.51215933482606624,0.51215933482601983,0.5121593348259752,0.51215933482593234,0.51215933482589115,0.51215933482585163,0.51215933482581355,0.51215933482577702,0.51215933482574183,0.51215933482570819,0.51215933482567577,0.51215933482564457,0.5121593348256146,0.51215933482558584,0.51215933482555809,0.51215933482553155,0.51215933482550602,0.51215933482548148,0.51215933482545783,0.51215933482543519,0.51215933482541343,0.51215933482539255,0.51215933482537235,0.51215933482535303,0.51215933482533449,0.51215933482531661,0.51215933482529941,0.51215933482528297,0.5121593348252671,0.51215933482525189,0.51215933482523723,0.51215933482522324,0.5121593348252097,0.51215933482519671,0.51215933482518428,0.51215933482517217,0.51215933482516074,0.51215933482514964,0.51215933482513898,0.51215933482512876,0.51215933482511899,0.51215933482510945,0.51215933482510045,0.51215933482509168,0.51215933482508336,0.51215933482507525,0.51215933482506759,0.51215933482506015,0.51215933482505294,0.51215933482504605,0.5121593348250395,0.51215933482503317,0.51215933482502707,0.51215933482502118,0.51215933482501563,0.51215933482501019,0.51215933482500497,0.51215933482499998,0.5121593348249952,0.51215933482499054,0.5121593348249861,0.51215933482498188,0.51215933482497777,0.51215933482497378,0.51215933482497,0.51215933482496645,0.51215933482496301,0.51215933482495957,0.51215933482495635,0.51215933482495324,0.51215933482495035,0.51215933482494747,0.51215933482494469,0.51215933482494203,0.51215933482493947,0.51215933482493703,0.5121593348249347,0.51215933482493248,0.51215933482493026,0.51215933482492826,0.51215933482492626,0.51215933482492426,0.51215933482492249,0.51215933482492071,0.51215933482491893,0.51215933482491727,0.51215933482491582,0.51215933482491427,0.51215933482491283,0.51215933482491138,0.51215933482491005,0.51215933482490872,0.5121593348249075,0.51215933482490628,0.51215933482490517,0.51215933482490406,0.51215933482490306,0.51215933482490206,0.51215933482490106,0.51215933482490006,0.51215933482489917,0.51215933482489839,0.51215933482489751,0.51215933482489673,0.51215933482489595,0.51215933482489517,0.51215933482489451,0.51215933482489373,0.51215933482489318,0.51215933482489251,0.51215933482489195,0.51215933482489129,0.51215933482489084,0.51215933482489029,0.51215933482488973,0.51215933482488918,0.51215933482488873,0.51215933482488829,0.51215933482488785,0.5121593348248874,0.51215933482488707,0.51215933482488663,0.51215933482488618,0.51215933482488585,0.51215933482488551,0.51215933482488518,0.51215933482488485,0.51215933482488452,0.51215933482488429,0.51215933482488396,0.51215933482488374,0.51215933482488352,0.51215933482488318,0.51215933482488296,0.51215933482488274,0.51215933482488252,0.5121593348248823,0.51215933482488207,0.51215933482488185,0.51215933482488174,0.51215933482488152,0.5121593348248813,0.51215933482488118,0.51215933482488096,0.51215933482488085,0.51215933482488063,0.51215933482488052,0.51215933482488041,0.5121593348248803,0.51215933482488019,0.51215933482488007,0.51215933482487996,0.51215933482487985,0.51215933482487963,0.51215933482487963,0.51215933482487941,0.51215933482487941,0.5121593348248793,0.51215933482487919,0.51215933482487908,0.51215933482487908,0.51215933482487896,0.51215933482487885,0.51215933482487885,0.51215933482487874,0.51215933482487863,0.51215933482487863,0.51215933482487852,0.51215933482487852,0.51215933482487841,0.51215933482487841,0.5121593348248783,0.5121593348248783,0.51215933482487819,0.51215933482487819,0.51215933482487808,0.51215933482487808,0.51215933482487808,0.51215933482487797,0.51215933482487797,0.51215933482487797,0.51215933482487785,0.51215933482487785,0.51215933482487785,0.51215933482487774,0.51215933482487774,0.51215933482487774,0.51215933482487763,0.51215933482487763,0.51215933482487763,0.51215933482487763,0.51215933482487763,0.51215933482487752,0.51215933482487752,0.51215933482487752,0.51215933482487752,0.51215933482487752,0.51215933482487741,0.51215933482487741,0.51215933482487741,0.51215933482487741,0.51215933482487741,0.51215933482487741,0.5121593348248773,0.5121593348248773,0.5121593348248773,0.5121593348248773,0.5121593348248773,0.5121593348248773,0.5121593348248773,0.5121593348248773,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487719,0.51215933482487719,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487697,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487697,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487708,0.51215933482487697,0.51215933482487697,0.51215933482487708,0.51215933482487697,0.51215933482487708,0.51215933482487697,0.51215933482487697,0.51215933482487708,0.51215933482487697,0.51215933482487708,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487708,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487708,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697],"mode":"lines+markers","name":"Pérdida","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Evolución de la Pérdida con Gradiente Descendente","xaxis":{"domain":[0,1],"automargin":true,"title":"Iteración"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Pérdida"},"annotations":[{"x":916,"y":0.51215933482487697,"text":"Mínima pérdida: 0.51","showarrow":true,"arrowhead":7,"ax":-40,"ay":-40}],"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1000],"y":[0.98529411764705888,0.96683076946248303,0.94908792469165204,0.93203746681073596,0.91565237649946662,0.89990668882447822,0.88477545209349961,0.87023468831519812,0.85626135520201707,0.84283330965579284,0.82992927267828853,0.81752879565104031,0.80561222793107901,0.79416068571118015,0.78315602209529167,0.77258079834172377,0.76241825622852755,0.75265229149727131,0.74326742833313286,0.73424879484086614,0.7255820994777803,0.71725360840638441,0.70925012373081109,0.7015589625825287,0.69416793702220159,0.68706533472584885,0.68023990042469595,0.67368081806930669,0.66737769368973243,0.6613205389245177,0.65549975519245929,0.64990611848204072,0.64453076473443105,0.639365175796894,0.6344011659243397,0.62963086880763475,0.62504672510811088,0.62064147047852092,0.61640812405145773,0.61233997737699464,0.6084305837920182,0.60467374820440445,0.60106351727585317,0.59759416998782178,0.59426020857560813,0.59105634981621658,0.58797751665620279,0.5850188301662278,0.58217560180957273,0.57944332601236404,0.57681767302373266,0.57429448205459566,0.57186975468418511,0.56953964852387784,0.56730047112828352,0.56514867414394399,0.56308084768636923,0.5610937149365024,0.55918412694804775,0.5573490576574357,0.55558559908851546,0.55389095674437749,0.55226244517900314,0.55069748374172289,0.54919359248774124,0.54774838824824712,0.54635958085388114,0.54502496950557755,0.54374243928702692,0.54250995781323585,0.54132557200987064,0.54018740501828244,0.53909365322130853,0.53804258338513788,0.53703252991270989,0.53606189220429568,0.53512913212107882,0.53423277154771498,0.53337139005000933,0.53254362262400035,0.53174815753288007,0.53098373422832734,0.5302491413529562,0.52954321482071676,0.52886483597220435,0.52821292980195589,0.52758646325492264,0.52698444358942031,0.52640591680396343,0.52584996612548873,0.52531571055657433,0.52480230347935097,0.52430893131389356,0.52383481222896644,0.52337919490308105,0.52294135733389946,0.52252060569410119,0.52211627323189647,0.52172771921444594,0.52135432791251135,0.52099550762472979,0.52065068973996209,0.5203193278362338,0.52000089681483708,0.5196948920682235,0.51940082868036852,0.51911824065834045,0.51884668019385605,0.51858571695365319,0.5183349373975551,0.51809394412314647,0.51786235523602264,0.51763980374461327,0.51742593697862271,0.51722041603016433,0.51702291521670429,0.51683312156496219,0.51665073431495301,0.51647546444338144,0.51630703420563639,0.51614517669565763,0.5159896354229786,0.51584016390627352,0.51569652528276688,0.51555849193288361,0.51542584511954892,0.51529837464156103,0.51517587850049318,0.51505816258059267,0.5149450403411715,0.5148363325210018,0.5147318668542461,0.51463147779747265,0.51453500626732462,0.51444229938842556,0.51435321025112213,0.51426759767868191,0.51418532600357447,0.51410626485248334,0.51403028893970781,0.51395727786862699,0.51388711594090997,0.51381969197317334,0.51375489912079231,0.51369263470858695,0.51363280006811629,0.51357530038132193,0.51352004453027233,0.51346694495277134,0.51341591750360149,0.51336688132118091,0.51331975869942525,0.51327447496460943,0.51323095835703381,0.5131891399173093,0.51314895337707989,0.51311033505400871,0.51307322375086306,0.5130375606585369,0.51300328926285799,0.51297035525503165,0.51293870644557948,0.51290829268163596,0.51287906576747333,0.51285097938812674,0.51282398903600124,0.51279805194034078,0.51277312699945199,0.51274917471557102,0.51272615713227243,0.51270403777432161,0.5126827815898729,0.51266235489492451,0.51264272531994015,0.51262386175855446,0.51260573431827949,0.51258831427313523,0.51257157401812803,0.51255548702550635,0.51254002780272279,0.51252517185203683,0.51251089563169439,0.51249717651862137,0.51248399277257406,0.51247132350168789,0.51245914862937092,0.51244744886248861,0.51243620566079129,0.51242540120753355,0.51241501838124059,0.51240504072857662,0.51239545243827178,0.51238623831606633,0.51237738376063258,0.51236887474043724,0.51236069777150572,0.51235283989605451,0.51234528866195728,0.51233803210301265,0.51233105871998186,0.51232435746236549,0.51231791771089319,0.51231172926069479,0.51230578230512935,0.51230006742024492,0.51229457554984448,0.51228929799113498,0.51228422638093662,0.51227935268242919,0.51227466917241726,0.51227016842909079,0.5122658433202647,0.51226168699207586,0.51225769285812284,0.51225385458902806,0.51225016610240814,0.5122466215532353,0.51224321532457462,0.51223994201868372,0.51223679644845832,0.51223377362921307,0.51223086877078206,0.51222807726992814,0.5122253947030484,0.51222281681916415,0.51222033953318447,0.51221795891943289,0.51221567120542599,0.51221347276589613,0.5122113601170456,0.51220932991102697,0.51220737893063706,0.51220550408421894,0.51220370240076296,0.51220197102519849,0.51220030721386944,0.51219870833018688,0.51219717184045033,0.51219569530983333,0.51219427639852455,0.51219291285802027,0.51219160252756113,0.51219034333070768,0.51218913327205073,0.51218797043404873,0.51218685297398914,0.51218577912106844,0.51218474717358575,0.51218375549624673,0.51218280251757187,0.51218188672740583,0.51218100667452504,0.51218016096433761,0.51217934825667333,0.51217856726366029,0.51217781674768348,0.51217709551942403,0.5121764024359744,0.51217573639902725,0.51217509635313474,0.51217448128403675,0.5121738902170524,0.51217332221553691,0.51217277637939607,0.51217225184366066,0.51217174777711572,0.51217126338098273,0.51217079788765463,0.51217035055947879,0.51216992068758838,0.51216950759077928,0.51216911061442982,0.51216872912946443,0.51216836253135567,0.51216801023916736,0.51216767169463306,0.51216734636127215,0.512167033723539,0.5121667332860067,0.5121664445725812,0.51216616712574758,0.51216590050584465,0.51216564429036826,0.51216539807330186,0.51216516146447311,0.51216493408893549,0.51216471558637422,0.51216450561053517,0.51216430382867617,0.51216410992104011,0.51216392358034768,0.51216374451131053,0.51216357243016375,0.5121634070642157,0.51216324815141645,0.51216309543994165,0.51216294868779444,0.51216280766242117,0.5121626721403435,0.51216254190680399,0.51216241675542551,0.51216229648788469,0.51216218091359744,0.5121620698494167,0.5121619631193427,0.51216186055424373,0.51216176199158803,0.51216166727518642,0.51216157625494485,0.5121614887866266,0.5121614047316233,0.51216132395673553,0.51216124633396198,0.51216117174029641,0.51216110005753235,0.51216103117207668,0.5121609649747686,0.51216090136070735,0.51216084022908581,0.51216078148303057,0.51216072502944865,0.51216067077887995,0.51216061864535523,0.51216056854626002,0.51216052040220417,0.51216047413689503,0.51216042967701747,0.51216038695211752,0.51216034589449022,0.51216030643907284,0.51216026852334184,0.51216023208721306,0.51216019707294747,0.51216016342505921,0.51216013109022729,0.51216010001721179,0.51216007015677245,0.51216004146159022,0.51216001388619281,0.51215998738688229,0.51215996192166613,0.51215993745019039,0.51215991393367588,0.51215989133485673,0.51215986961792137,0.51215984874845544,0.51215982869338805,0.51215980942093842,0.51215979090056607,0.51215977310292249,0.51215975599980423,0.51215973956410843,0.51215972376979024,0.51215970859182058,0.51215969400614758,0.51215967998965772,0.51215966652013967,0.51215965357624849,0.51215964113747259,0.51215962918410041,0.51215961769719009,0.51215960665853855,0.5121595960506532,0.51215958585672405,0.51215957606059703,0.51215956664674878,0.51215955760026122,0.51215954890679871,0.51215954055258506,0.51215953252438151,0.51215952480946625,0.51215951739561349,0.51215951027107476,0.51215950342456007,0.51215949684522,0.51215949052262832,0.51215948444676607,0.51215947860800481,0.51215947299709208,0.51215946760513653,0.51215946242359367,0.51215945744425251,0.51215945265922225,0.5121594480609204,0.51215944364206012,0.51215943939563902,0.5121594353149278,0.5121594313934601,0.51215942762502142,0.51215942400364034,0.51215942052357799,0.51215941717931956,0.51215941396556575,0.51215941087722361,0.51215940790939918,0.51215940505738944,0.51215940231667512,0.51215939968291269,0.51215939715192882,0.51215939471971272,0.51215939238241004,0.51215939013631695,0.51215938797787408,0.51215938590366117,0.51215938391039117,0.51215938199490529,0.51215938015416851,0.51215937838526349,0.51215937668538714,0.51215937505184594,0.51215937348205109,0.51215937197351513,0.5121593705238473,0.51215936913075055,0.51215936779201732,0.51215936650552596,0.512159365269238,0.51215936408119422,0.51215936293951203,0.51215936184238209,0.51215936078806612,0.51215935977489302,0.51215935880125751,0.51215935786561662,0.51215935696648762,0.51215935610244567,0.51215935527212175,0.5121593544741998,0.51215935370741561,0.51215935297055393,0.51215935226244713,0.51215935158197312,0.51215935092805354,0.51215935029965221,0.51215934969577315,0.51215934911545957,0.51215934855779188,0.51215934802188623,0.51215934750689351,0.5121593470119975,0.51215934653641415,0.51215934607938962,0.51215934564019983,0.51215934521814865,0.51215934481256742,0.5121593444228133,0.51215934404826891,0.51215934368834037,0.5121593433424575,0.51215934301007215,0.51215934269065766,0.51215934238370775,0.51215934208873626,0.51215934180527545,0.51215934153287623,0.51215934127110707,0.51215934101955296,0.51215934077781533,0.51215934054551127,0.51215934032227239,0.512159340107745,0.51215933990158935,0.5121593397034786,0.51215933951309867,0.51215933933014812,0.51215933915433698,0.51215933898538657,0.51215933882302911,0.51215933866700747,0.51215933851707429,0.5121593383729921,0.51215933823453241,0.51215933810147596,0.51215933797361179,0.51215933785073731,0.51215933773265776,0.51215933761918619,0.51215933751014264,0.51215933740535424,0.51215933730465524,0.51215933720788576,0.51215933711489248,0.51215933702552818,0.51215933693965121,0.51215933685712545,0.51215933677782011,0.51215933670160951,0.51215933662837299,0.51215933655799439,0.51215933649036216,0.51215933642536926,0.51215933636291244,0.51215933630289301,0.51215933624521581,0.51215933618978926,0.51215933613652564,0.51215933608534059,0.51215933603615293,0.51215933598888486,0.51215933594346119,0.51215933589981022,0.51215933585786266,0.51215933581755202,0.51215933577881434,0.51215933574158845,0.51215933570581529,0.51215933567143801,0.51215933563840221,0.51215933560665572,0.51215933557614801,0.5121593355468308,0.51215933551865767,0.51215933549158399,0.5121593354655668,0.51215933544056491,0.51215933541653857,0.51215933539344993,0.51215933537126224,0.5121593353499404,0.51215933532945057,0.51215933530976043,0.51215933529083868,0.51215933527265523,0.51215933525518131,0.51215933523838941,0.51215933522225265,0.51215933520674572,0.51215933519184398,0.51215933517752366,0.51215933516376211,0.51215933515053758,0.5121593351378293,0.51215933512561673,0.51215933511388079,0.51215933510260292,0.51215933509176514,0.51215933508135025,0.51215933507134181,0.51215933506172384,0.51215933505248123,0.51215933504359945,0.51215933503506406,0.51215933502686184,0.5121593350189797,0.51215933501140509,0.51215933500412614,0.51215933499713118,0.51215933499040933,0.51215933498394961,0.51215933497774213,0.51215933497177679,0.51215933496604427,0.51215933496053534,0.51215933495524146,0.51215933495015431,0.51215933494526555,0.51215933494056753,0.51215933493605292,0.51215933493171439,0.51215933492754528,0.51215933492353882,0.51215933491968868,0.51215933491598875,0.51215933491243326,0.51215933490901655,0.51215933490573307,0.51215933490257781,0.51215933489954568,0.5121593348966319,0.51215933489383181,0.51215933489114085,0.51215933488855503,0.51215933488607013,0.51215933488368215,0.51215933488138732,0.51215933487918219,0.512159334877063,0.51215933487502652,0.51215933487306953,0.51215933487118881,0.51215933486938159,0.51215933486764487,0.51215933486597587,0.51215933486437204,0.51215933486283083,0.51215933486134979,0.51215933485992648,0.51215933485855869,0.5121593348572443,0.51215933485598131,0.5121593348547675,0.51215933485360099,0.51215933485248011,0.51215933485140297,0.5121593348503678,0.51215933484937315,0.51215933484841714,0.51215933484749854,0.51215933484661569,0.51215933484576748,0.51215933484495224,0.51215933484416876,0.51215933484341603,0.51215933484269249,0.51215933484199727,0.51215933484132925,0.51215933484068721,0.51215933484007026,0.51215933483947729,0.51215933483890752,0.51215933483836007,0.51215933483783393,0.51215933483732823,0.51215933483684239,0.51215933483637543,0.51215933483592668,0.51215933483549558,0.51215933483508125,0.51215933483468301,0.51215933483430032,0.51215933483393261,0.51215933483357923,0.51215933483323961,0.5121593348329132,0.51215933483259968,0.51215933483229825,0.51215933483200871,0.51215933483173037,0.51215933483146292,0.5121593348312059,0.51215933483095899,0.51215933483072162,0.51215933483049358,0.51215933483027443,0.51215933483006371,0.51215933482986131,0.5121593348296668,0.51215933482947984,0.51215933482930032,0.51215933482912768,0.51215933482896181,0.51215933482880238,0.51215933482864928,0.51215933482850207,0.51215933482836051,0.51215933482822462,0.51215933482809395,0.51215933482796838,0.51215933482784781,0.5121593348277319,0.51215933482762044,0.51215933482751341,0.5121593348274105,0.51215933482731169,0.51215933482721665,0.51215933482712528,0.51215933482703757,0.51215933482695331,0.51215933482687226,0.51215933482679443,0.5121593348267196,0.51215933482664766,0.5121593348265786,0.51215933482651221,0.51215933482644826,0.51215933482638709,0.51215933482632814,0.51215933482627152,0.51215933482621712,0.51215933482616471,0.51215933482611453,0.51215933482606624,0.51215933482601983,0.5121593348259752,0.51215933482593234,0.51215933482589115,0.51215933482585163,0.51215933482581355,0.51215933482577702,0.51215933482574183,0.51215933482570819,0.51215933482567577,0.51215933482564457,0.5121593348256146,0.51215933482558584,0.51215933482555809,0.51215933482553155,0.51215933482550602,0.51215933482548148,0.51215933482545783,0.51215933482543519,0.51215933482541343,0.51215933482539255,0.51215933482537235,0.51215933482535303,0.51215933482533449,0.51215933482531661,0.51215933482529941,0.51215933482528297,0.5121593348252671,0.51215933482525189,0.51215933482523723,0.51215933482522324,0.5121593348252097,0.51215933482519671,0.51215933482518428,0.51215933482517217,0.51215933482516074,0.51215933482514964,0.51215933482513898,0.51215933482512876,0.51215933482511899,0.51215933482510945,0.51215933482510045,0.51215933482509168,0.51215933482508336,0.51215933482507525,0.51215933482506759,0.51215933482506015,0.51215933482505294,0.51215933482504605,0.5121593348250395,0.51215933482503317,0.51215933482502707,0.51215933482502118,0.51215933482501563,0.51215933482501019,0.51215933482500497,0.51215933482499998,0.5121593348249952,0.51215933482499054,0.5121593348249861,0.51215933482498188,0.51215933482497777,0.51215933482497378,0.51215933482497,0.51215933482496645,0.51215933482496301,0.51215933482495957,0.51215933482495635,0.51215933482495324,0.51215933482495035,0.51215933482494747,0.51215933482494469,0.51215933482494203,0.51215933482493947,0.51215933482493703,0.5121593348249347,0.51215933482493248,0.51215933482493026,0.51215933482492826,0.51215933482492626,0.51215933482492426,0.51215933482492249,0.51215933482492071,0.51215933482491893,0.51215933482491727,0.51215933482491582,0.51215933482491427,0.51215933482491283,0.51215933482491138,0.51215933482491005,0.51215933482490872,0.5121593348249075,0.51215933482490628,0.51215933482490517,0.51215933482490406,0.51215933482490306,0.51215933482490206,0.51215933482490106,0.51215933482490006,0.51215933482489917,0.51215933482489839,0.51215933482489751,0.51215933482489673,0.51215933482489595,0.51215933482489517,0.51215933482489451,0.51215933482489373,0.51215933482489318,0.51215933482489251,0.51215933482489195,0.51215933482489129,0.51215933482489084,0.51215933482489029,0.51215933482488973,0.51215933482488918,0.51215933482488873,0.51215933482488829,0.51215933482488785,0.5121593348248874,0.51215933482488707,0.51215933482488663,0.51215933482488618,0.51215933482488585,0.51215933482488551,0.51215933482488518,0.51215933482488485,0.51215933482488452,0.51215933482488429,0.51215933482488396,0.51215933482488374,0.51215933482488352,0.51215933482488318,0.51215933482488296,0.51215933482488274,0.51215933482488252,0.5121593348248823,0.51215933482488207,0.51215933482488185,0.51215933482488174,0.51215933482488152,0.5121593348248813,0.51215933482488118,0.51215933482488096,0.51215933482488085,0.51215933482488063,0.51215933482488052,0.51215933482488041,0.5121593348248803,0.51215933482488019,0.51215933482488007,0.51215933482487996,0.51215933482487985,0.51215933482487963,0.51215933482487963,0.51215933482487941,0.51215933482487941,0.5121593348248793,0.51215933482487919,0.51215933482487908,0.51215933482487908,0.51215933482487896,0.51215933482487885,0.51215933482487885,0.51215933482487874,0.51215933482487863,0.51215933482487863,0.51215933482487852,0.51215933482487852,0.51215933482487841,0.51215933482487841,0.5121593348248783,0.5121593348248783,0.51215933482487819,0.51215933482487819,0.51215933482487808,0.51215933482487808,0.51215933482487808,0.51215933482487797,0.51215933482487797,0.51215933482487797,0.51215933482487785,0.51215933482487785,0.51215933482487785,0.51215933482487774,0.51215933482487774,0.51215933482487774,0.51215933482487763,0.51215933482487763,0.51215933482487763,0.51215933482487763,0.51215933482487763,0.51215933482487752,0.51215933482487752,0.51215933482487752,0.51215933482487752,0.51215933482487752,0.51215933482487741,0.51215933482487741,0.51215933482487741,0.51215933482487741,0.51215933482487741,0.51215933482487741,0.5121593348248773,0.5121593348248773,0.5121593348248773,0.5121593348248773,0.5121593348248773,0.5121593348248773,0.5121593348248773,0.5121593348248773,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487719,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487719,0.51215933482487719,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487697,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487697,0.51215933482487708,0.51215933482487708,0.51215933482487708,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487708,0.51215933482487697,0.51215933482487697,0.51215933482487708,0.51215933482487697,0.51215933482487708,0.51215933482487697,0.51215933482487697,0.51215933482487708,0.51215933482487697,0.51215933482487708,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487708,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487708,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697,0.51215933482487697],"mode":"lines+markers","name":"Pérdida","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En el gráfico anterior, hemos agregado puntos en cada paso (iteración) para visualizar mejor cómo disminuye la pérdida a lo largo de las iteraciones. También hemos incluido una anotación que indica la pérdida mínima alcanzada.</p>
<p>Visualizamos la evolución de los parámetros:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df_params_gd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  Iteración <span class="ot">=</span> iterations,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mu =</span> mu_history_gd,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Alpha =</span> alpha_history_gd</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de Mu</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>plot_mu <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(df_params_gd, <span class="at">x =</span> <span class="sc">~</span>Iteración, <span class="at">y =</span> <span class="sc">~</span>Mu, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, <span class="at">name =</span> <span class="st">'Mu'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Evolución de Mu con Gradiente Descendente'</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Iteración'</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Mu'</span>))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de Alpha</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>plot_alpha <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(df_params_gd, <span class="at">x =</span> <span class="sc">~</span>Iteración, <span class="at">y =</span> <span class="sc">~</span>Alpha, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, <span class="at">name =</span> <span class="st">'Alpha'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Evolución de Alpha con Gradiente Descendente'</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Iteración'</span>),</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Alpha'</span>))</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="fu">subplot</span>(plot_mu, plot_alpha, <span class="at">nrows =</span> <span class="dv">2</span>, <span class="at">shareX =</span> <span class="cn">TRUE</span>, <span class="at">titleX =</span> <span class="cn">TRUE</span>, <span class="at">titleY =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Evolución de los Parámetros con Gradiente Descendente'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-2514ce28ae593bde0f73" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2514ce28ae593bde0f73">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1000],"y":[2.019167104758298e-18,3.6518480233247047e-18,5.0916685083854547e-18,7.053946887387455e-18,8.9968371804814791e-18,1.0388697663559341e-17,1.2184646673982389e-17,1.4117332711335373e-17,1.563572596560213e-17,1.6913298784380343e-17,1.8652103962653566e-17,2.0366418927148293e-17,2.1382762798955881e-17,2.2778704984330159e-17,2.4080768016886867e-17,2.547262849996473e-17,2.6905306006006752e-17,2.7819607320403937e-17,2.8611457565908645e-17,2.9382899299931273e-17,3.0293118912032043e-17,3.0729861057748554e-17,3.1227828737911305e-17,3.1513547898660425e-17,3.2093149624751502e-17,3.2966633916184531e-17,3.31625556264125e-17,3.3880935230581719e-17,3.4574824620972439e-17,3.5276877415955996e-17,3.5546269767519455e-17,3.6207505539538852e-17,3.6476897891102311e-17,3.7227931113642859e-17,3.6966702166672231e-17,3.7293238350385511e-17,3.7799369435141099e-17,3.8305500519896687e-17,3.8787141390873777e-17,3.8836121818430768e-17,3.8599383085238638e-17,3.9032043528658737e-17,3.9407560139929008e-17,3.9505520995042989e-17,4.0256554217583538e-17,4.0942280203381427e-17,4.0648397638039476e-17,4.0974933821752756e-17,4.0852482752860276e-17,4.0664724447225138e-17,4.0860646157453107e-17,4.1121875104423735e-17,4.1138201913609397e-17,4.1325960219244535e-17,4.1660659807550646e-17,4.1676986616736308e-17,4.1595352570807988e-17,4.1660659807550646e-17,4.1350450433023027e-17,4.1783110876443126e-17,4.1995359395856757e-17,4.1758620662664628e-17,4.1611679379993649e-17,4.1709640235107631e-17,4.1644332998364972e-17,4.1252489577909033e-17,4.1268816387094695e-17,4.1317796814651686e-17,4.1301470005466024e-17,4.1121875104423716e-17,4.0738195088560609e-17,4.0917789989602916e-17,4.1138201913609384e-17,4.1113711699830886e-17,4.0485129546182818e-17,4.001981548439139e-17,3.949735759045014e-17,3.9227965238886682e-17,3.8909592459766232e-17,3.8289173710710995e-17,3.8134069023447186e-17,3.8191212855597007e-17,3.7978964336183376e-17,3.7611611129505936e-17,3.7652428152470096e-17,3.7562630701948945e-17,3.7505486869799124e-17,3.6917721739115216e-17,3.6680983005923086e-17,3.6754453647258576e-17,3.6615675769180434e-17,3.6256485967095825e-17,3.5978930210939535e-17,3.5595250195076427e-17,3.5423818698626956e-17,3.5195243370027658e-17,3.493401442305703e-17,3.4558497811786759e-17,3.4387066315337288e-17,3.4297268864816137e-17,3.4509517384229768e-17,3.4346249292373128e-17,3.4191144605109319e-17,3.4191144605109319e-17,3.391358884895303e-17,3.3611542879018242e-17,3.3905425444360193e-17,3.4182981200516482e-17,3.3970732681102851e-17,3.396256927651002e-17,3.3987059490288519e-17,3.3807464589246211e-17,3.379930118465338e-17,3.363603309279674e-17,3.3807464589246211e-17,3.3831954803024709e-17,3.375848416168922e-17,3.3750320757096389e-17,3.3538072237682759e-17,3.3154392221819651e-17,3.3015614343741509e-17,3.274622199217805e-17,3.2770712205956549e-17,3.290132667944186e-17,3.282785603810637e-17,3.266458794624973e-17,3.2444176022243263e-17,3.2060496006380155e-17,3.2003352174230333e-17,3.1831920677780862e-17,3.1840084082373693e-17,3.1872737700745022e-17,3.1929881532894844e-17,3.1840084082373693e-17,3.1791103654816702e-17,3.1668652585924222e-17,3.1554364921624573e-17,3.1358443211396604e-17,3.1284972570061114e-17,3.1309462783839613e-17,3.1268645760875453e-17,3.1235992142504123e-17,3.1235992142504123e-17,3.0966599790940665e-17,3.0770678080712695e-17,3.0411488278628086e-17,3.0101278904100467e-17,2.9742089102015858e-17,2.9595147819344879e-17,2.9529840582602221e-17,2.939922610911691e-17,2.9309428658595759e-17,2.9170650780517618e-17,2.8933912047325488e-17,2.8844114596804338e-17,2.8852278001397168e-17,2.846043458094123e-17,2.8133898397227949e-17,2.806042775589246e-17,2.7791035404329002e-17,2.7358374960908903e-17,2.7244087296609254e-17,2.7227760487423589e-17,2.7227760487423589e-17,2.7146126441495269e-17,2.7350211556316069e-17,2.7505316243579878e-17,2.7644094121658023e-17,2.7513479648172709e-17,2.744000900683722e-17,2.7676747740029349e-17,2.7897159664035814e-17,2.7464499220615715e-17,2.744000900683722e-17,2.7423682197651555e-17,2.7554296671136869e-17,2.7733891572179174e-17,2.7448172411430054e-17,2.7431845602244389e-17,2.719510686905226e-17,2.7146126441495269e-17,2.7235923892016423e-17,2.7015511968009958e-17,2.6737956211853669e-17,2.6672648975111013e-17,2.6795100044003493e-17,2.6893060899117478e-17,2.6844080471560487e-17,2.6762446425632167e-17,2.6795100044003496e-17,2.6901224303710312e-17,2.6974694945045801e-17,2.6860407280746152e-17,2.6746119616446503e-17,2.6452237051104549e-17,2.6337949386804899e-17,2.6329785982212068e-17,2.6460400455697382e-17,2.6346112791397733e-17,2.6746119616446503e-17,2.6574688119997029e-17,2.6297132363840739e-17,2.6288968959247908e-17,2.6427746837326053e-17,2.6615505142961189e-17,2.6656322165925349e-17,2.6729792807260838e-17,2.6737956211853669e-17,2.6525707692440035e-17,2.6403256623547555e-17,2.6623668547554019e-17,2.6893060899117478e-17,2.7023675372602792e-17,2.7244087296609257e-17,2.7342048151723241e-17,2.7268577510387752e-17,2.7252250701202087e-17,2.7635930717065192e-17,2.7693074549215017e-17,2.7546133266544041e-17,2.7586950289508201e-17,2.7644094121658026e-17,2.7684911144622186e-17,2.785634264107166e-17,2.7701237953807851e-17,2.7668584335436522e-17,2.7603277098693866e-17,2.7513479648172712e-17,2.7301231128759078e-17,2.7023675372602789e-17,2.6803263448596324e-17,2.6852243876153315e-17,2.7048165586381284e-17,2.682775366237482e-17,2.6925714517488804e-17,2.6656322165925346e-17,2.679510004400349e-17,2.6648158761332515e-17,2.667264897511101e-17,2.6721629402668001e-17,2.6550197906218527e-17,2.6631831952146847e-17,2.6754283021039327e-17,2.6705302593482336e-17,2.6574688119997022e-17,2.6370603005176222e-17,2.6280805554655068e-17,2.6150191081169755e-17,2.6068557035241434e-17,2.6182844699541084e-17,2.6223661722505244e-17,2.601141320309161e-17,2.5856308515827801e-17,2.5660386805599831e-17,2.5807328088270807e-17,2.5497118713743188e-17,2.5554262545893013e-17,2.5464465095371859e-17,2.5505282118336019e-17,2.5146092316251409e-17,2.5170582530029905e-17,2.531752381270088e-17,2.5146092316251406e-17,2.4835882941723788e-17,2.4827719537130957e-17,2.4876699964687948e-17,2.4811392727945292e-17,2.4680778254459978e-17,2.4574653994753163e-17,2.4729758682016972e-17,2.4648124636088652e-17,2.4484856544232012e-17,2.4476693139639181e-17,2.4517510162603341e-17,2.4174647169704397e-17,2.4027705887033421e-17,2.3733823321691467e-17,2.3848110985991116e-17,2.3913418222733772e-17,2.3839947581398282e-17,2.3774640344655627e-17,2.3464430970128008e-17,2.3390960328792519e-17,2.3341979901235528e-17,2.3317489687457033e-17,2.3121567977229064e-17,2.3162385000193224e-17,2.3048097335893574e-17,2.282768541188711e-17,2.274605136595879e-17,2.290931945781543e-17,2.2656253915437636e-17,2.274605136595879e-17,2.242767858683834e-17,2.2354207945502851e-17,2.2150122830682051e-17,2.210114240312506e-17,2.214195942608922e-17,2.1872567074525761e-17,2.1741952601040447e-17,2.1946037715861248e-17,2.2068488784753728e-17,2.1946037715861248e-17,2.2011344952603903e-17,2.1733789196447614e-17,2.1668481959704958e-17,2.1586847913776638e-17,2.1635828341333629e-17,2.1382762798955835e-17,2.1619501532147964e-17,2.1660318555112124e-17,2.1864403669932924e-17,2.1586847913776635e-17,2.1431743226512826e-17,2.1276638539249016e-17,2.1146024065763703e-17,2.1137860661170872e-17,2.0835814691236087e-17,2.0639892981008118e-17,2.0558258935079798e-17,2.0403154247815988e-17,2.0525605316708468e-17,2.0158252110031028e-17,2.0117435087066868e-17,2.0329683606480502e-17,2.0648056385600952e-17,2.0941938950942906e-17,2.0664383194786616e-17,2.0697036813157945e-17,2.0329683606480505e-17,2.0582749148858299e-17,2.0648056385600955e-17,2.0272539774330681e-17,2.0133761896252536e-17,2.0117435087066871e-17,2.0223559346773687e-17,2.0174578919216696e-17,2.0117435087066871e-17,2.0092944873288376e-17,2.0043964445731385e-17,2.0207232537588025e-17,2.026437636973785e-17,2.0035801041138554e-17,1.986436954468908e-17,1.986436954468908e-17,1.9684774643646776e-17,1.9676611239053945e-17,1.9464362719640311e-17,1.9341911650747831e-17,1.9603140597718456e-17,1.9725591666610936e-17,1.97419184757966e-17,1.9611304002311286e-17,1.9856206140096246e-17,1.9856206140096246e-17,1.9839879330910582e-17,1.9725591666610933e-17,1.9570486979347123e-17,1.9227623986448178e-17,1.9145989940519858e-17,1.9113336322148529e-17,1.9113336322148529e-17,1.9235787391041009e-17,1.9186806963484018e-17,1.8966395039477554e-17,1.8925578016513394e-17,1.8892924398142064e-17,1.8966395039477554e-17,1.8574551619021615e-17,1.86725124741356e-17,1.86725124741356e-17,1.8901087802734895e-17,1.8803126947620911e-17,1.8525571191464621e-17,1.851740778687179e-17,1.8443937145536301e-17,1.8623532046578606e-17,1.868067587872843e-17,1.8452100550129135e-17,1.8296995862865326e-17,1.8248015435308335e-17,1.8043930320487535e-17,1.802760351130187e-17,1.782351839648107e-17,1.7750047755145581e-17,1.7627596686253101e-17,1.7586779663288941e-17,1.7627596686253101e-17,1.786433541944523e-17,1.7586779663288941e-17,1.7488818808174956e-17,1.7268406884168491e-17,1.7374531143875307e-17,1.7562289449510442e-17,1.7643923495438762e-17,1.7594943067881771e-17,1.7562289449510442e-17,1.7619433281660267e-17,1.7423511571432297e-17,1.7309223907132648e-17,1.7203099647425833e-17,1.7145955815276008e-17,1.7252080074982824e-17,1.7407184762246633e-17,1.7203099647425833e-17,1.7252080074982824e-17,1.7235753265797159e-17,1.7211263052018663e-17,1.712146560149751e-17,1.7015341341790694e-17,1.695819750964087e-17,1.703983155556919e-17,1.7276570288761319e-17,1.7292897097946984e-17,1.7431674976025128e-17,1.7407184762246633e-17,1.7464328594396457e-17,1.7480655403582122e-17,1.7325550716318313e-17,1.6982687723419368e-17,1.6541863875406439e-17,1.6533700470813608e-17,1.6354105569771303e-17,1.6313288546807143e-17,1.6468393234070952e-17,1.6199000882507494e-17,1.6174510668728998e-17,1.6174510668728998e-17,1.6043896195243684e-17,1.6076549813615014e-17,1.6199000882507494e-17,1.6158183859543334e-17,1.6084713218207844e-17,1.610920343198634e-17,1.63541055697713e-17,1.6541863875406435e-17,1.6484720043256611e-17,1.6550027279999266e-17,1.684390984534122e-17,1.6705131967263076e-17,1.6288798333028641e-17,1.6582680898370595e-17,1.6901053677491045e-17,1.692554389126954e-17,1.6794929417784226e-17,1.6803092822377057e-17,1.6892890272898211e-17,1.6623497921334752e-17,1.6656151539706082e-17,1.6607171112149091e-17,1.6860236654526885e-17,1.668064175348458e-17,1.6631661325927589e-17,1.6705131967263079e-17,1.6827583036155559e-17,1.6966360914233703e-17,1.6754112394820069e-17,1.6778602608598565e-17,1.6819419631562725e-17,1.6541863875406435e-17,1.647655663866378e-17,1.6492883447849445e-17,1.6607171112149094e-17,1.6492883447849445e-17,1.643573961569962e-17,1.6419412806513955e-17,1.6247981310064481e-17,1.6076549813615007e-17,1.6215327691693152e-17,1.6207164287100321e-17,1.6117366836579168e-17,1.6003079172279518e-17,1.5896954912572703e-17,1.5994915767686687e-17,1.6239817905471648e-17,1.6378595783549792e-17,1.6411249401921122e-17,1.6305125142214306e-17,1.6403085997328291e-17,1.6460229829478115e-17,1.6386759188142626e-17,1.6501046852442275e-17,1.6468393234070946e-17,1.6321451951399971e-17,1.6166347264136161e-17,1.5847974485015712e-17,1.5554091919673758e-17,1.5211228926774813e-17,1.5105104667067998e-17,1.5137758285439327e-17,1.5309189781888801e-17,1.5439804255374115e-17,1.5276536163517475e-17,1.5374497018631459e-17,1.5284699568110306e-17,1.521939233136765e-17,1.5211228926774819e-17,1.5007143811954019e-17,1.4998980407361188e-17,1.4958163384397028e-17,1.4696934437426404e-17,1.4329581230748963e-17,1.4084679092964003e-17,1.3986718237850019e-17,1.4101005902149668e-17,1.4492849322605607e-17,1.4329581230748967e-17,1.4362234849120296e-17,1.4084679092964006e-17,1.3815286741400549e-17,1.3994881642442856e-17,1.3611201626579751e-17,1.3415279916351781e-17,1.3554057794429926e-17,1.3749979504657895e-17,1.3505077366872934e-17,1.3668345458729574e-17,1.4035698665407016e-17,1.4149986329706665e-17,1.4035698665407016e-17,1.4117332711335336e-17,1.4043862069999846e-17,1.3905084191921702e-17,1.3823450145993382e-17,1.3774469718436389e-17,1.3954064619478696e-17,1.408467909296401e-17,1.412549611592817e-17,1.4280600803191979e-17,1.420713016185649e-17,1.4182639948077994e-17,1.412549611592817e-17,1.397039142866436e-17,1.401120845162852e-17,1.3896920787328871e-17,1.3807123336807719e-17,1.3741816100065062e-17,1.3652018649543909e-17,1.3603038221986917e-17,1.3929574405700197e-17,1.386426716895754e-17,1.366018205413674e-17,1.361936503117258e-17,1.3970391428664357e-17,1.3725489290879395e-17,1.4215293566449317e-17,1.4378561658305957e-17,1.4492849322605607e-17,1.4566319963941096e-17,1.4574483368533927e-17,1.4419378681270117e-17,1.4280600803191973e-17,1.4239783780227813e-17,1.4084679092964003e-17,1.3970391428664354e-17,1.3921411001107363e-17,1.3660182054136739e-17,1.3782633123029219e-17,1.3700999077100899e-17,1.3594874817394082e-17,1.3700999077100899e-17,1.3815286741400546e-17,1.3913247596514529e-17,1.375814290925072e-17,1.4109169306742499e-17,1.4060188879185508e-17,1.3921411001107363e-17,1.3929574405700194e-17,1.3676508863322402e-17,1.3758142909250722e-17,1.3717325886286562e-17,1.3954064619478689e-17,1.3945901214885859e-17,1.3970391428664354e-17,1.3619365031172577e-17,1.3660182054136737e-17,1.3700999077100897e-17,1.3896920787328865e-17,1.3741816100065055e-17,1.3937737810293025e-17,1.3807123336807712e-17,1.3790796527622048e-17,1.3684672267915231e-17,1.3676508863322399e-17,1.3586711412801246e-17,1.3905084191921696e-17,1.396222802407152e-17,1.411733271133533e-17,1.448468591801277e-17,1.432141782615613e-17,1.4386725062898785e-17,1.4476522513419939e-17,1.4558156559348259e-17,1.4378561658305954e-17,1.436223484912029e-17,1.428060080319197e-17,1.3872430573550368e-17,1.4052025474592674e-17,1.4133659520520994e-17,1.4068352283778339e-17,1.3945901214885859e-17,1.3790796527622049e-17,1.3798959932214882e-17,1.3864267168957539e-17,1.4117332711335333e-17,1.4035698665407013e-17,1.386426716895754e-17,1.4035698665407013e-17,1.4239783780227813e-17,1.4133659520520997e-17,1.4011208451628517e-17,1.3872430573550372e-17,1.3856103764364708e-17,1.4117332711335333e-17,1.4027535260814179e-17,1.3954064619478689e-17,1.3733652695472225e-17,1.3782633123029217e-17,1.3782633123029217e-17,1.3758142909250722e-17,1.3733652695472226e-17,1.3847940359771874e-17,1.3725489290879394e-17,1.3888757382736034e-17,1.3570384603615585e-17,1.34724237485016e-17,1.3790796527622049e-17,1.3700999077100897e-17,1.3856103764364706e-17,1.3700999077100897e-17,1.4109169306742499e-17,1.3945901214885859e-17,1.4141822925113828e-17,1.4207130161856483e-17,1.4443868895048613e-17,1.4305091016970468e-17,1.3994881642442849e-17,1.3913247596514529e-17,1.3643855244951072e-17,1.3603038221986912e-17,1.371732588628656e-17,1.3488750557687263e-17,1.3619365031172575e-17,1.4076515688371169e-17,1.4182639948077985e-17,1.404386206999984e-17,1.404386206999984e-17,1.416631313889232e-17,1.437039825371312e-17,1.4427542085862945e-17,1.4639790605276579e-17,1.4615300391498084e-17,1.4394888467491619e-17,1.4533666345569764e-17,1.4435705490455779e-17,1.4533666345569764e-17,1.4492849322605604e-17,1.440305187208445e-17,1.4615300391498084e-17,1.4656117414462244e-17,1.4631627200683748e-17,1.4713261246612068e-17,1.4468359108827108e-17,1.4149986329706659e-17,1.4084679092964003e-17,1.4264273994006308e-17,1.4264273994006308e-17,1.4166313138892323e-17,1.4460195704234277e-17,1.4394888467491622e-17,1.4394888467491622e-17,1.4207130161856486e-17,1.4190803352670822e-17,1.4272437398599142e-17,1.4370398253713127e-17,1.4664280819055081e-17,1.4664280819055081e-17,1.477856848335473e-17,1.4517339536384105e-17,1.4525502940976936e-17,1.4754078269576231e-17,1.5056124239511016e-17,1.5031634025732521e-17,1.4852039124690216e-17,1.4876529338468711e-17,1.4713261246612071e-17,1.4680607628240742e-17,1.4427542085862948e-17,1.4411215276677284e-17,1.4533666345569764e-17,1.4558156559348259e-17,1.4598973582312419e-17,1.4631627200683748e-17,1.4476522513419939e-17,1.4509176131791268e-17,1.4427542085862948e-17,1.4264273994006308e-17,1.4011208451628514e-17,1.4043862069999843e-17,1.4027535260814179e-17,1.3970391428664354e-17,1.4027535260814179e-17,1.3717325886286562e-17,1.3513240771465761e-17,1.3684672267915234e-17,1.3652018649543906e-17,1.3807123336807716e-17,1.3896920787328868e-17,1.4231620375634982e-17,1.4068352283778342e-17,1.4141822925113831e-17,1.3839776955179046e-17,1.3660182054136742e-17,1.3798959932214886e-17,1.3684672267915239e-17,1.4027535260814185e-17,1.421529356644932e-17,1.421529356644932e-17,1.3905084191921702e-17,1.3758142909250725e-17,1.3684672267915237e-17,1.3717325886286565e-17,1.3847940359771877e-17,1.3945901214885862e-17,1.3954064619478693e-17,1.3913247596514532e-17,1.3798959932214885e-17,1.4035698665407013e-17,1.3954064619478693e-17,1.3790796527622052e-17,1.382345014599338e-17,1.3945901214885862e-17,1.4117332711335336e-17,1.429692761237764e-17,1.4198966757263656e-17,1.4043862069999846e-17,1.3905084191921702e-17,1.4035698665407016e-17,1.3896920787328871e-17,1.3700999077100902e-17,1.3896920787328871e-17,1.3847940359771879e-17,1.3994881642442856e-17,1.39295744057002e-17,1.376630631384356e-17,1.3652018649543912e-17,1.3921411001107369e-17,1.3921411001107369e-17,1.364385524495108e-17,1.388875738273604e-17,1.4109169306742505e-17,1.4272437398599145e-17,1.4305091016970474e-17,1.4223456971042154e-17,1.4272437398599145e-17,1.4158149734299496e-17,1.4060188879185511e-17,1.4035698665407016e-17,1.4190803352670825e-17,1.4386725062898794e-17,1.4345908039934634e-17,1.4182639948077994e-17,1.409284249755684e-17,1.4003045047035686e-17,1.3627528435765412e-17,1.3676508863322405e-17,1.3668345458729572e-17,1.3823450145993382e-17,1.3717325886286565e-17,1.3880593978143206e-17,1.3684672267915237e-17,1.3978554833257191e-17,1.3668345458729574e-17,1.3488750557687269e-17,1.3700999077100902e-17,1.3603038221986917e-17,1.3554057794429925e-17,1.3790796527622054e-17,1.4166313138892326e-17,1.4190803352670822e-17,1.4403051872084456e-17,1.441937868127012e-17,1.4362234849120296e-17,1.4321417826156136e-17,1.4484685918012776e-17,1.4492849322605607e-17,1.4656117414462247e-17,1.4549993154755431e-17,1.4647954009869416e-17,1.4443868895048616e-17,1.4133659520520997e-17,1.3945901214885862e-17,1.4060188879185511e-17,1.3945901214885862e-17,1.3725489290879397e-17,1.3937737810293031e-17,1.3807123336807719e-17,1.3635691840358246e-17,1.3611201626579751e-17,1.3676508863322408e-17,1.3349972679609126e-17,1.3211194801530981e-17,1.3480587153094438e-17,1.3562221199022758e-17,1.3578548008208423e-17,1.3480587153094438e-17,1.3684672267915239e-17,1.3758142909250726e-17,1.4101005902149671e-17,1.3888757382736037e-17,1.3831613550586212e-17,1.3872430573550372e-17,1.3709162481693732e-17,1.4060188879185511e-17,1.3847940359771879e-17,1.3774469718436391e-17,1.3864267168957543e-17,1.3978554833257191e-17,1.3643855244951077e-17,1.3562221199022757e-17,1.321119480153098e-17,1.3390789702573285e-17,1.3431606725537445e-17,1.305609011426717e-17,1.3194867992345315e-17,1.345609693931594e-17,1.325201182449514e-17,1.3186704587752483e-17,1.3309155656644963e-17,1.2941802449967521e-17,1.3039763305081506e-17,1.3096907137231331e-17,1.2688736907589729e-17,1.2631593075439904e-17,1.2549959029511584e-17,1.2892822022410529e-17,1.2876495213224864e-17,1.3007109686710177e-17,1.294180244996752e-17,1.3080580328045664e-17,1.3056090114267169e-17,1.2990782877524512e-17,1.2852004999446367e-17,1.28601684040392e-17,1.2786697762703712e-17,1.3056090114267169e-17,1.3203031396938146e-17,1.3170377778566818e-17,1.3292828847459298e-17,1.3145887564788321e-17,1.3415279916351778e-17,1.3349972679609121e-17,1.3407116511758946e-17,1.3252011824495137e-17,1.3227521610716641e-17,1.3113233946416994e-17,1.2966292663746017e-17,1.3129560755602657e-17,1.2843841594853535e-17,1.2558122434104413e-17,1.2476488388176093e-17,1.2386690937654941e-17,1.2362200723876445e-17,1.273771733514672e-17,1.2688736907589727e-17,1.2721390525961055e-17,1.294180244996752e-17,1.2688736907589727e-17,1.2484651792768927e-17,1.269690031218256e-17,1.2492815197361759e-17,1.2664246693811232e-17,1.2672410098404064e-17,1.2819351381075041e-17,1.3137724160195491e-17,1.3211194801530978e-17,1.3129560755602658e-17,1.3325482465830628e-17,1.357854800820842e-17,1.3529567580651428e-17,1.3390789702573283e-17,1.3594874817394083e-17,1.3888757382736037e-17,1.3970391428664357e-17,1.3733652695472228e-17,1.3880593978143203e-17,1.3872430573550371e-17,1.4019371856221348e-17,1.3994881642442853e-17,1.3929574405700197e-17,1.3652018649543908e-17,1.3709162481693732e-17,1.3692835672508068e-17,1.3709162481693732e-17,1.366018205413674e-17,1.3725489290879397e-17,1.3782633123029222e-17,1.3529567580651429e-17,1.3782633123029222e-17,1.405202547459268e-17,1.4117332711335336e-17,1.4019371856221351e-17,1.4125496115928166e-17,1.4166313138892326e-17,1.4117332711335336e-17,1.4084679092964006e-17,1.421529356644932e-17,1.4141822925113831e-17,1.4182639948077991e-17,1.3913247596514532e-17,1.3880593978143203e-17,1.3864267168957539e-17,1.3700999077100899e-17,1.4052025474592677e-17,1.4003045047035686e-17,1.3986718237850022e-17,1.3921411001107366e-17,1.3962228024071526e-17,1.3921411001107366e-17,1.3880593978143206e-17,1.3741816100065062e-17,1.3831613550586214e-17,1.3937737810293031e-17,1.3725489290879399e-17,1.3619365031172582e-17,1.3570384603615589e-17,1.3537730985244262e-17,1.3349972679609124e-17,1.3325482465830629e-17,1.3398953107166117e-17,1.3537730985244262e-17,1.3521404176058597e-17,1.3398953107166117e-17,1.3627528435765414e-17,1.3823450145993383e-17,1.3570384603615591e-17,1.3815286741400552e-17,1.405202547459268e-17,1.3978554833257191e-17,1.3643855244951077e-17,1.3790796527622054e-17,1.3986718237850022e-17,1.3921411001107366e-17,1.3994881642442856e-17,1.4068352283778345e-17,1.401120845162852e-17,1.4182639948077994e-17,1.4158149734299499e-17,1.4394888467491628e-17,1.4501012727198444e-17,1.4745914864983404e-17,1.4770405078761899e-17,1.4623463796090924e-17,1.4549993154755434e-17,1.437856165830596e-17,1.4190803352670825e-17,1.4501012727198444e-17,1.4517339536384108e-17,1.4460195704234284e-17,1.424794718482065e-17,1.4117332711335336e-17,1.3856103764364711e-17,1.4231620375634985e-17,1.420713016185649e-17,1.4305091016970474e-17,1.4337744635341803e-17,1.4778568483354733e-17,1.4647954009869419e-17,1.457448336853393e-17,1.4525502940976939e-17,1.4688771032833579e-17,1.4345908039934634e-17,1.417447654348516e-17,1.4272437398599145e-17,1.4019371856221351e-17,1.3741816100065062e-17,1.3839776955179046e-17,1.3505077366872932e-17,1.3611201626579749e-17,1.3578548008208422e-17,1.3733652695472231e-17,1.3586711412801254e-17,1.3594874817394086e-17,1.3611201626579751e-17,1.3611201626579751e-17,1.3586711412801255e-17,1.3513240771465768e-17,1.3578548008208425e-17,1.356222119902276e-17,1.3700999077100905e-17,1.3635691840358248e-17,1.3415279916351783e-17,1.3578548008208423e-17,1.3782633123029223e-17,1.3733652695472231e-17,1.3905084191921705e-17,1.3872430573550377e-17,1.3913247596514539e-17,1.4027535260814188e-17,1.3978554833257197e-17],"mode":"lines+markers","name":"Mu","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1000],"y":[24.71563586159898,48.944228310631154,72.695374967285346,95.978484322176058,118.80277946330862,141.17730172960123,163.11091429241102,184.61230566648308,205.68999315171314,226.35232620708717,246.6074897581347,266.46350743920578,285.9282447718557,305.00941228059753,323.71456854725528,342.05112320512899,360.02633987415629,377.64733903823515,394.92110086584535,411.85446797508797,428.45414814423668,444.72671696887568,460.67862046667625,476.31617763084364,491.6455829332466,506.67290877821983,521.40410790801275,535.84501576083619,550.00135278244227,563.87872669215187,577.48263470422899,590.81846570547987,603.89150238994159,616.70692335150341,629.26980513529327,641.58512424863807,653.65775913239611,665.49249209344498,677.09401119908489,688.46691213411361,699.61570002130497,710.54479120601354,721.25851500561168,731.76111542445301,742.0567528350407,752.14950562606691,762.04337181797575,771.74227064669105,781.25004411613452,790.57045852015096,799.70720593444105,808.66390567909662,817.44410575231336,826.05128423585211,834.48885067280332,842.76014741820291,850.86845096303148,858.81697323212359,866.60886285650133,874.24720642063392,881.73502968512048,889.07529878527737,896.27092140610762,903.32474793411563,910.23957258642474,917.01813451764417,923.66311890492489,930.17715801163263,936.5628322300613,942.82267110359737,948.95915432874313,954.97471273739336,960.87172925975551,966.65253986829464,972.31943450307722,977.87465797888024,983.32041087442497,988.65885040408671,993.89209127242862,999.02220651189441,1004.0512283039943,1008.9811487843086,1013.8139208316286,1018.5514588415454,1023.1956394847962,1027.7483024506655,1032.2112511757366,1036.5862535582842,1040.8750426585877,1045.079317385444,1049.2007431691534,1053.2409526212425,1057.2015461811875,1061.0840927503923,1064.8901303136749,1068.6211665485046,1072.2786794222359,1075.864117777573,1079.3789019064961,1082.8244241128789,1086.2020492640183,1089.5131153312968,1092.7589339201909,1095.9407907898333,1099.0599463623385,1102.1176362220913,1105.1150716051961,1108.0534398792809,1110.9339050138469,1113.7576080413496,1116.5256675091925,1119.239179922816,1121.8992201800536,1124.506841996928,1127.0630783250581,1129.5689417608398,1132.0254249465636,1134.4335009636272,1136.7941237180019,1139.108228318099,1141.3767314451941,1143.6005317165495,1145.7805100413814,1147.9175299698118,1150.0124380349469,1152.0660640882099,1154.0792216280706,1156.0527081222929,1157.9873053238348,1159.883779580523,1161.7428821386234,1163.5653494404319,1165.351903415999,1167.1032517691062,1168.8200882576082,1170.5030929682484,1172.1529325860613,1173.7702606584642,1175.3557178541464,1176.9099322168547,1178.4335194141804,1179.9270829814411,1181.3912145607587,1182.8264941354253,1184.2334902596497,1185.6127602837792,1186.9648505750799,1188.2902967341699,1189.5896238071839,1190.8633464937589,1192.1119693509222,1193.3359869929589,1194.5358842873436,1195.7121365468095,1196.8652097176332,1197.9955605642083,1199.1036368499831,1200.1898775148325,1201.2547128489332,1202.2985646632148,1203.3218464564504,1204.3249635790546,1205.3083133936545,1206.2722854324963,1207.2172615517491,1208.1436160827695,1209.0517159803844,1209.9419209682524,1210.8145836813592,1211.6700498057078,1212.5086582152533,1213.3307411061398,1214.1366241282942,1214.926626514424,1215.7010612064739,1216.4602349795925,1217.2044485636522,1217.9339967623791,1218.6491685701315,1219.3502472863779,1220.0375106279216,1220.7112308389117,1221.371674798685,1222.0191041274863,1222.6537752901027,1223.2759396974554,1223.8858438061927,1224.4837292163168,1225.0698327668883,1225.6443866298457,1226.2076184019743,1226.7597511950637,1227.3010037242891,1227.8315903948508,1228.3517213869043,1228.86160273882,1229.3614364288012,1229.8514204548912,1230.3317489134085,1230.8026120758316,1231.2641964641714,1231.716684924859,1232.1602567011739,1232.5950875042499,1233.021349582677,1233.439211790735,1233.8488396552814,1234.2503954413205,1234.6440382162816,1235.0299239130302,1235.408205391637,1235.7790324999303,1236.1425521328542,1236.4989082906588,1236.8482421359417,1237.1906920495678,1237.526393685484,1237.8554800244572,1238.1780814267506,1238.4943256837637,1238.8043380686531,1239.1082413859583,1239.4061560202458,1239.6981999837988,1239.9844889633641,1240.2651363659791,1240.5402533638955,1240.8099489386177,1241.0743299240733,1241.3335010489332,1241.5875649780974,1241.8366223533633,1242.0807718332928,1242.3201101322948,1242.5547320589337,1242.784730553489,1243.0101967247692,1243.2312198862037,1243.4478875912216,1243.6602856679347,1243.8684982531363,1244.0726078256293,1244.2726952388998,1244.4688397531438,1244.6611190666663,1244.8496093466574,1245.0343852593664,1245.215519999678,1245.3930853201068,1245.5671515592214,1245.7377876695061,1245.9050612446767,1246.0690385464541,1246.229784530814,1246.3873628737176,1246.5418359963344,1246.6932650897704,1246.8417101393063,1246.9872299481599,1247.1298821607804,1247.2697232856817,1247.4068087178275,1247.5411927605751,1247.6729286471864,1247.8020685619142,1247.9286636606753,1248.052764091314,1248.1744190134666,1248.2936766180355,1248.410584146279,1248.5251879085249,1248.6375333025146,1248.7476648313875,1248.8556261213093,1248.961459938753,1249.0652082074414,1249.1669120249524,1249.2666116790008,1249.364346663396,1249.4601556936868,1249.5540767224984,1249.6461469545659,1249.736402861472,1249.8248801960951,1249.9116140067708,1249.9966386511776,1250.0799878099444,1250.1616944999946,1250.2417910876231,1250.320309301319,1250.3972802443332,1250.4727344069997,1250.5467016788136,1250.6192113602713,1250.6902921744768,1250.7599722785199,1250.8282792746302,1250.8952402211114,1250.9608816430591,1251.0252295428684,1251.0883094105345,1251.1501462337494,1251.2107645078008,1251.2701882452757,1251.3284409855705,1251.3855458042185,1251.4415253220286,1251.4964017140464,1251.5501967183391,1251.6029316446061,1251.6546273826202,1251.705304410503,1251.7549828028361,1251.8036822386146,1251.8514220090408,1251.8982210251675,1251.9440978253881,1251.9890705827811,1252.0331571123077,1252.0763748778697,1252.1187409992283,1252.1602722587836,1252.2009851082244,1252.2408956750435,1252.2800197689285,1252.3183728880219,1252.3559702250629,1252.3928266734035,1252.4289568329089,1252.4643750157418,1252.4990952520304,1252.5331312954279,1252.5664966285581,1252.5992044683589,1252.6312677713167,1252.6626992385986,1252.6935113210841,1252.723716224297,1252.7533259132408,1252.7823521171376,1252.8108063340753,1252.8386998355618,1252.8660436709893,1252.8928486720129,1252.9191254568398,1252.9448844344363,1252.9701358086509,1252.9948895822558,1253.0191555609103,1253.0429433570444,1253.0662623936664,1253.0891219080959,1253.1115309556237,1253.133498413097,1253.1550329824379,1253.1761431940888,1253.1968374103926,1253.2171238289043,1253.2370104856395,1253.2565052582568,1253.2756158691784,1253.2943498886493,1253.3127147377365,1253.3307176912683,1253.3483658807158,1253.3656662970184,1253.3826257933526,1253.3992510878472,1253.4155487662447,1253.4315252845088,1253.4471869713836,1253.4625400308996,1253.4775905448307,1253.492344475105,1253.5068076661653,1253.5209858472838,1253.5348846348334,1253.5485095345107,1253.5618659435179,1253.5749591527003,1253.5877943486432,1253.6003766157248,1253.6127109381316,1253.6248022018319,1253.6366551965125,1253.6482746174743,1253.6596650674937,1253.670831058645,1253.6817770140883,1253.6925072698214,1253.7030260763972,1253.7133376006084,1253.7234459271367,1253.7333550601716,1253.7430689249966,1253.7525913695442,1253.7619261659197,1253.7710770118963,1253.7800475323784,1253.7888412808393,1253.7974617407276,1253.8059123268474,1253.8141963867115,1253.8223172018666,1253.8302779891935,1253.8380819021818,1253.8457320321788,1253.8532314096142,1253.8605830052002,1253.8677897311086,1253.8748544421237,1253.881779936775,1253.8885689584433,1253.8952241964496,1253.9017482871184,1253.9081438148241,1253.9144133130133,1253.9205592652088,1253.9265841059935,1253.9324902219744,1253.9382799527286,1253.9439555917295,1253.9495193872563,1253.9549735432829,1253.9603202203525,1253.9655615364327,1253.9706995677548,1253.9757363496362,1253.9806738772866,1253.985514106598,1253.9902589549197,1253.9949103018189,1253.999469989823,1254.003939825152,1254.0083215784318,1254.012616985397,1254.016827747578,1254.0209555329745,1254.0250019767179,1254.0289686817168,1254.0328572192936,1254.0366691298066,1254.0404059232594,1254.0440690799001,1254.0476600508068,1254.0511802584635,1254.0546310973223,1254.0580139343563,1254.0613301096018,1254.0645809366881,1254.0677677033582,1254.0708916719791,1254.0739540800421,1254.0769561406521,1254.0798990430087,1254.0827839528779,1254.0856120130527,1254.0883843438062,1254.0911020433362,1254.0937661881987,1254.0963778337361,1254.0989380144938,1254.1014477446306,1254.1039080183207,1254.1063198101467,1254.108684075487,1254.1110017508925,1254.1132737544592,1254.1155009861909,1254.1176843283563,1254.1198246458375,1254.1219227864744,1254.1239795813988,1254.1259958453643,1254.1279723770692,1254.129909959473,1254.131809360106,1254.1336713313733,1254.135496610854,1254.1372859215921,1254.1390399723832,1254.1407594580558,1254.142445059746,1254.1440974451677,1254.1457172688768,1254.1473051725302,1254.148861785141,1254.150387723327,1254.1518835915545,1254.1533499823786,1254.1547874766779,1254.1561966438835,1254.1575780422061,1254.1589322188559,1254.1602597102597,1254.1615610422741,1254.1628367303929,1254.1640872799519,1254.1653131863281,1254.1665149351377,1254.1676930024266,1254.1688478548601,1254.1699799499074,1254.1710897360229,1254.1721776528236,1254.173244131264,1254.1742895938057,1254.1753144545855,1254.1763191195794,1254.177303986763,1254.17826944627,1254.1792158805454,1254.1801436644982,1254.1810531656499,1254.1819447442788,1254.1828187535639,1254.1836755397251,1254.1845154421587,1254.1853387935741,1254.1861459201232,1254.1869371415314,1254.1877127712239,1254.1884731164487,1254.1892184784001,1254.1899491523363,1254.1906654276981,1254.191367588222,1254.1920559120529,1254.1927306718555,1254.1933921349209,1254.1940405632731,1254.194676213772,1254.1952993382174,1254.1959101834454,1254.1965089914295,1254.1970959993739,1254.1976714398088,1254.1982355406819,1254.19878852545,1254.1993306131649,1254.1998620185632,1254.2003829521493,1254.2008936202794,1254.2013942252436,1254.201884965345,1254.2023660349801,1254.2028376247131,1254.2032999213545,1254.2037531080327,1254.2041973642674,1254.2046328660413,1254.2050597858681,1254.2054782928633,1254.2058885528088,1254.20629072822,1254.2066849784101,1254.207071459552,1254.2074503247422,1254.2078217240596,1254.2081858046256,1254.2085427106629,1254.2088925835517,1254.2092355618865,1254.2095717815307,1254.2099013756701,1254.2102244748662,1254.2105412071076,1254.2108516978606,1254.2111560701192,1254.2114544444541,1254.2117469390594,1254.2120336698003,1254.2123147502591,1254.2125902917794,1254.2128604035111,1254.2131251924527,1254.2133847634946,1254.21363921946,1254.213888661146,1254.2141331873636,1254.2143728949766,1254.214607878939,1254.2148382323353,1254.2150640464147,1254.2152854106284,1254.2155024126653,1254.2157151384852,1254.2159236723551,1254.2161280968812,1254.2163284930416,1254.216524940219,1254.2167175162313,1254.2169062973633,1254.2170913583966,1254.2172727726388,1254.2174506119534,1254.2176249467875,1254.2177958461998,1254.2179633778885,1254.2181276082172,1254.2182886022426,1254.2184464237384,1254.2186011352226,1254.2187527979804,1254.2189014720898,1254.2190472164446,1254.2191900887783,1254.2193301456869,1254.2194674426503,1254.2196020340559,1254.219733973219,1254.2198633124046,1254.2199901028475,1254.2201143947727,1254.220236237416,1254.2203556790423,1254.2204727669659,1254.220587547569,1254.2207000663188,1254.2208103677874,1254.2209184956682,1254.2210244927937,1254.2211284011523,1254.221230261905,1254.2213301154018,1254.2214280011972,1254.2215239580667,1254.2216180240214,1254.2217102363234,1254.2218006315006,1254.2218892453611,1254.2219761130073,1254.22206126885,1254.2221447466216,1254.2222265793898,1254.2223067995715,1254.2223854389438,1254.2224625286574,1254.2225380992506,1254.2226121806584,1254.2226848022267,1254.222755992723,1254.2228257803479,1254.2228941927458,1254.2229612570172,1254.2230269997278,1254.2230914469205,1254.2231546241242,1254.2232165563655,1254.2232772681773,1254.2233367836093,1254.2233951262372,1254.2234523191719,1254.2235083850696,1254.2235633461394,1254.2236172241528,1254.2236700404524,1254.2237218159601,1254.2237725711857,1254.2238223262348,1254.223871100817,1254.2239189142529,1254.2239657854827,1254.2240117330737,1254.2240567752267,1254.2241009297845,1254.2241442142376,1254.2241866457325,1254.2242282410773,1254.2242690167493,1254.2243089889005,1254.2243481733653,1254.2243865856656,1254.2244242410177,1254.2244611543379,1254.2244973402483,1254.2245328130837,1254.2245675868953,1254.2246016754584,1254.2246350922762,1254.2246678505862,1254.2246999633649,1254.2247314433328,1254.2247623029602,1254.2247925544714,1254.2248222098499,1254.224851280843,1254.2248797789666,1254.2249077155093,1254.224935101538,1254.2249619479007,1254.2249882652322,1254.2250140639574,1254.2250393542961,1254.2250641462665,1254.2250884496889,1254.2251122741911,1254.2251356292102,1254.2251585239983,1254.2251809676245,1254.2252029689791,1254.2252245367774,1254.2252456795636,1254.2252664057123,1254.225286723434,1254.225306640777,1254.2253261656313,1254.2253453057313,1254.2253640686583,1254.2253824618456,1254.2254004925787,1254.2254181680005,1254.2254354951124,1254.2254524807784,1254.2254691317266,1254.2254854545533,1254.2255014557243,1254.2255171415782,1254.2255325183282,1254.2255475920661,1254.2255623687627,1254.2255768542711,1254.2255910543302,1254.2256049745642,1254.2256186204879,1254.2256319975068,1254.2256451109197,1254.2256579659211,1254.2256705676032,1254.2256829209584,1254.2256950308795,1254.2257069021641,1254.2257185395147,1254.2257299475409,1254.2257411307619,1254.2257520936075,1254.2257628404207,1254.2257733754584,1254.2257837028938,1254.2257938268181,1254.2258037512415,1254.2258134800954,1254.2258230172338,1254.2258323664341,1254.2258415314004,1254.2258505157631,1254.2258593230811,1254.2258679568429,1254.2258764204687,1254.2258847173114,1254.2258928506574,1254.2259008237286,1254.2259086396837,1254.2259163016183,1254.2259238125678,1254.2259311755072,1254.2259383933535,1254.2259454689658,1254.2259524051469,1254.2259592046446,1254.2259658701519,1254.2259724043097,1254.2259788097062,1254.2259850888786,1254.2259912443146,1254.2259972784518,1254.2260031936814,1254.2260089923461,1254.226014676743,1254.2260202491238,1254.2260257116961,1254.2260310666234,1254.2260363160271,1254.2260414619868,1254.2260465065408,1254.2260514516872,1254.2260562993854,1254.2260610515552,1254.2260657100794,1254.2260702768035,1254.2260747535358,1254.2260791420504,1254.2260834440854,1254.226087661345,1254.2260917954998,1254.2260958481875,1254.2260998210133,1254.2261037155511,1254.2261075333436,1254.2261112759033,1254.2261149447122,1254.2261185412242,1254.2261220668638,1254.2261255230273,1254.2261289110843,1254.2261322323768,1254.2261354882201,1254.2261386799041,1254.2261418086932,1254.2261448758268,1254.2261478825196,1254.226150829963,1254.2261537193244,1254.2261565517485,1254.226159328357,1254.2261620502502,1254.226164718506,1254.2261673341816,1254.2261698983127,1254.2261724119155,1254.2261748759856,1254.226177291499,1254.2261796594123,1254.226181980664,1254.2261842561736,1254.2261864868419,1254.2261886735532,1254.2261908171733,1254.2261929185515,1254.2261949785202,1254.2261969978956,1254.2261989774772,1254.2262009180492,1254.2262028203809,1254.2262046852252,1254.2262065133211,1254.2262083053929,1254.2262100621504,1254.2262117842893,1254.226213472492,1254.2262151274272,1254.2262167497504,1254.2262183401042,1254.2262198991186,1254.2262214274115,1254.226222925588,1254.2262243942416,1254.226225833954,1254.2262272452956,1254.2262286288255,1254.2262299850918,1254.2262313146316,1254.2262326179716,1254.2262338956282,1254.2262351481077,1254.2262363759057,1254.2262375795087,1254.2262387593939,1254.2262399160284,1254.2262410498704,1254.2262421613689,1254.2262432509644,1254.2262443190887,1254.2262453661644,1254.2262463926065,1254.2262473988219,1254.2262483852087,1254.226249352158,1254.2262503000527,1254.2262512292682,1254.2262521401728,1254.2262530331273,1254.2262539084852,1254.2262547665935,1254.2262556077919,1254.2262564324137,1254.2262572407858,1254.2262580332281,1254.2262588100546,1254.2262595715731,1254.2262603180852,1254.2262610498865,1254.226261767267,1254.2262624705113,1254.2262631598971,1254.2262638356981,1254.2262644981818,1254.2262651476108,1254.2262657842421,1254.226266408328,1254.2262670201158,1254.2262676198477,1254.2262682077614,1254.2262687840898,1254.2262693490611,1254.2262699028993,1254.2262704458233,1254.2262709780489,1254.2262714997862,1254.2262720112424,1254.2262725126197,1254.2262730041173,1254.2262734859291,1254.2262739582466,1254.2262744212567,1254.2262748751425,1254.2262753200841,1254.226275756258,1254.2262761838367,1254.2262766029896,1254.2262770138825,1254.2262774166786,1254.2262778115371,1254.2262781986146,1254.2262785780645,1254.2262789500369,1254.2262793146792,1254.2262796721359,1254.2262800225487,1254.2262803660565,1254.2262807027948,1254.2262810328975,1254.2262813564953,1254.2262816737164,1254.2262819846862,1254.2262822895282,1254.2262825883629,1254.2262828813089,1254.226283168482,1254.2262834499961,1254.2262837259627,1254.2262839964912,1254.2262842616888,1254.2262845216605,1254.2262847765091,1254.2262850263355,1254.2262852712392,1254.2262855113167,1254.2262857466633,1254.2262859773721,1254.2262862035345,1254.2262864252405,1254.2262866425772,1254.2262868556313,1254.226287064487,1254.226287269227,1254.2262874699325,1254.2262876666825,1254.2262878595557,1254.2262880486282,1254.2262882339749,1254.2262884156692,1254.226288593783,1254.2262887683869,1254.2262889395499,1254.2262891073401,1254.2262892718238,1254.2262894330663,1254.2262895911313,1254.2262897460816,1254.2262898979784,1254.2262900468818,1254.2262901928511,1254.2262903359438,1254.2262904762169,1254.226290613726,1254.2262907485249,1254.2262908806676,1254.2262910102065,1254.2262911371924,1254.2262912616761,1254.2262913837069,1254.226291503333,1254.2262916206014,1254.226291735559,1254.2262918482515,1254.2262919587231,1254.2262920670178,1254.2262921731785,1254.2262922772472,1254.226292379265,1254.2262924792726,1254.2262925773096,1254.2262926734145,1254.2262927676256,1254.2262928599803,1254.2262929505148,1254.2262930392656,1254.2262931262671,1254.2262932115543,1254.226293295161,1254.2262933771201,1254.226293457464,1254.2262935362248,1254.2262936134334,1254.2262936891207,1254.2262937633161,1254.2262938360498,1254.2262939073501,1254.2262939772456,1254.2262940457636,1254.2262941129313,1254.2262941787756,1254.2262942433222,1254.2262943065969,1254.2262943686246,1254.22629442943,1254.2262944890374,1254.2262945474702,1254.2262946047513],"mode":"lines+markers","name":"Alpha","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"Iteración","anchor":"y2"},"yaxis2":{"domain":[0,0.47999999999999998],"automargin":true,"title":"Alpha","anchor":"x"},"yaxis":{"domain":[0.52000000000000002,1],"automargin":true,"title":"Mu","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Evolución de los Parámetros con Gradiente Descendente","hovermode":"closest","showlegend":true},"attrs":{"672c8365497":{"x":{},"y":{},"mode":"lines+markers","name":"Mu","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"672c684a3221":{"x":{},"y":{},"mode":"lines+markers","name":"Alpha","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En los gráficos anteriores, hemos colocado los gráficos de los parámetros <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\alpha\)</span> uno debajo del otro para facilitar su visualización individual y apreciar cómo evolucionan a lo largo de las iteraciones.</p>
<p>Para visualizar la trayectoria del gradiente descendente en el espacio de parámetros, podemos graficar la función de pérdida en función de los parámetros y superponer los pasos del algoritmo.</p>
<p>Primero, generamos una cuadrícula de valores de <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\alpha\)</span> y calculamos la pérdida asociada:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear una cuadrícula de valores para mu y alpha</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>mu_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(mu_history_gd), <span class="fu">max</span>(mu_history_gd), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>alpha_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(alpha_history_gd), <span class="fu">max</span>(alpha_history_gd), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear una matriz para almacenar la pérdida</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>loss_grid <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(mu_seq), <span class="at">ncol =</span> <span class="fu">length</span>(alpha_seq))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mu_seq)) {</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(alpha_seq)) {</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    preds <span class="ot">&lt;-</span> mu_seq[i] <span class="sc">+</span> alpha_seq[j] <span class="sc">*</span> data<span class="sc">$</span>Sup</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    loss_grid[i, j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((data<span class="sc">$</span>Precio <span class="sc">-</span> preds)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Transponer la matriz para que coincida con los ejes</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>loss_grid <span class="ot">&lt;-</span> <span class="fu">t</span>(loss_grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Los valores finales obtenidos son:</p>
<ul>
<li><span class="math inline">\(\mu =\)</span> 109601.84</li>
<li><span class="math inline">\(\alpha =\)</span> 1254.23</li>
</ul>
</section>
</section>
</section>
<section id="resultados" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="resultados"><span class="header-section-number">4</span> Resultados</h2>
<p>Comparando los resultados obtenidos con ambos métodos, observamos que convergen a valores similares. Para validar el modelo, podemos comparar las predicciones con los valores reales.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones con los parámetros finales</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>preds_lj <span class="ot">&lt;-</span> mu_lj <span class="sc">+</span> alpha_lj <span class="sc">*</span> data<span class="sc">$</span>Sup</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>preds_gd <span class="ot">&lt;-</span> mu_gd <span class="sc">+</span> alpha_gd <span class="sc">*</span> data<span class="sc">$</span>Sup</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de comparación</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(data, <span class="at">x =</span> <span class="sc">~</span>Sup, <span class="at">y =</span> <span class="sc">~</span>Precio, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'markers'</span>, <span class="at">name =</span> <span class="st">'Datos Reales'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>Sup, <span class="at">y =</span> preds_lj, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Luus-Jaakola'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>Sup, <span class="at">y =</span> preds_gd, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Gradiente Descendente'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Ajuste del Modelo Lineal'</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Superficie Cubierta (Sup)'</span>),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Precio'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-5d05eac75555269eefd0" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5d05eac75555269eefd0">{"x":{"visdat":{"672c4a3539e":["function () ","plotlyVisDat"]},"cur_data":"672c4a3539e","attrs":{"672c4a3539e":{"x":{},"y":{},"mode":"markers","name":"Datos Reales","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"672c4a3539e.1":{"x":{},"y":[300031.64321089216,178300.0856241349,290756.85787094873,383504.71127038286,398576.23744779092,207283.78981145803,294234.90237342753,369592.53326046775,265251.19818610436,369592.53326046775,233948.79766379535,392779.49661032629,392779.49661032629,306987.73221584974,253657.71651117509,346405.56991060922,280322.72436351242,247860.97567371046,427559.94163511402,508714.31335961889,460021.69032491604,428719.28980260703,428719.28980260703,428719.28980260703,238586.19033376707,243223.58300373878,267569.8945210902,290756.85787094873,290756.85787094873,386982.75577286165,427559.94163511402,428719.28980260703,332493.39190069411,369592.53326046775,242064.23483624583,323218.60656075069,428719.28980260703,323218.60656075069,428719.28980260703,428719.28980260703,509873.66152711189,311625.12488582142,369592.53326046775,415966.45996018476,383504.71127038286,337130.7845706658,323218.60656075069,346405.56991060922,428719.28980260703,428719.28980260703,428719.28980260703,337130.7845706658,520307.79503454815,369592.53326046775,296553.59870841342,428719.28980260703,207283.78981145803,344086.87357562338,280322.72436351242,514511.05419708358,428719.28980260703,522626.49136953405,497120.83168468962,298872.29504339921,332493.39190069411,386982.75577286165,332493.39190069411,323218.60656075069],"mode":"lines","name":"Luus-Jaakola","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true},"672c4a3539e.2":{"x":{},"y":[285193.52157162974,153499.76063813086,275159.71121479175,375497.81478317181,391802.75661303359,184855.41800324962,278922.390098606,360447.09924791486,247566.73273348721,360447.09924791486,213702.62277915893,385531.62514000986,385531.62514000986,292718.87933925824,235024.46978743968,335362.5733558198,263871.67456334899,228753.33831441595,423158.41397815238,510954.25460048497,458276.75022708543,424412.64027275715,424412.64027275715,424412.64027275715,218719.52795757793,223736.43313599692,250075.18532269669,275159.71121479175,275159.71121479175,379260.49366698606,423158.41397815238,424412.64027275715,320311.85782056279,360447.09924791486,222482.20684139218,310278.04746372474,424412.64027275715,310278.04746372474,424412.64027275715,424412.64027275715,512208.48089508974,297735.78451767727,360447.09924791486,410616.15103210486,375497.81478317181,325328.76299898175,310278.04746372474,335362.5733558198,424412.64027275715,424412.64027275715,424412.64027275715,325328.76299898175,523496.5175465325,360447.09924791486,281430.84268781549,424412.64027275715,184855.41800324962,332854.12076661026,263871.67456334899,517225.38607350871,424412.64027275715,526004.97013574198,498411.99165443744,283939.29527702497,320311.85782056279,379260.49366698606,320311.85782056279,310278.04746372474],"mode":"lines","name":"Gradiente Descendente","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Ajuste del Modelo Lineal","xaxis":{"domain":[0,1],"automargin":true,"title":"Superficie Cubierta (Sup)"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Precio"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[140,35,132,212,225,60,135,200,110,200,83,220,220,146,100,180,123,95,250,320,278,251,251,251,87,91,112,132,132,215,250,251,168,200,90,160,251,160,251,251,321,150,200,240,212,172,160,180,251,251,251,172,330,200,137,251,60,178,123,325,251,332,310,139,168,215,168,160],"y":[215000,90000,239000,394900,480000,175000,250000,275000,165000,175000,225000,295000,450000,345000,295000,315000,290000,297000,450000,425000,290000,540000,540000,540000,177000,360000,190000,239000,229000,450000,379000,540000,295000,185000,243000,409000,540000,265000,540000,540000,300000,325000,175000,347000,394900,360000,265000,290000,540000,540000,540000,360000,425000,250000,325000,540000,145000,275000,290000,300000,540000,490000,590000,295000,295000,570000,295000,265000],"mode":"markers","name":"Datos Reales","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[140,35,132,212,225,60,135,200,110,200,83,220,220,146,100,180,123,95,250,320,278,251,251,251,87,91,112,132,132,215,250,251,168,200,90,160,251,160,251,251,321,150,200,240,212,172,160,180,251,251,251,172,330,200,137,251,60,178,123,325,251,332,310,139,168,215,168,160],"y":[300031.64321089216,178300.0856241349,290756.85787094873,383504.71127038286,398576.23744779092,207283.78981145803,294234.90237342753,369592.53326046775,265251.19818610436,369592.53326046775,233948.79766379535,392779.49661032629,392779.49661032629,306987.73221584974,253657.71651117509,346405.56991060922,280322.72436351242,247860.97567371046,427559.94163511402,508714.31335961889,460021.69032491604,428719.28980260703,428719.28980260703,428719.28980260703,238586.19033376707,243223.58300373878,267569.8945210902,290756.85787094873,290756.85787094873,386982.75577286165,427559.94163511402,428719.28980260703,332493.39190069411,369592.53326046775,242064.23483624583,323218.60656075069,428719.28980260703,323218.60656075069,428719.28980260703,428719.28980260703,509873.66152711189,311625.12488582142,369592.53326046775,415966.45996018476,383504.71127038286,337130.7845706658,323218.60656075069,346405.56991060922,428719.28980260703,428719.28980260703,428719.28980260703,337130.7845706658,520307.79503454815,369592.53326046775,296553.59870841342,428719.28980260703,207283.78981145803,344086.87357562338,280322.72436351242,514511.05419708358,428719.28980260703,522626.49136953405,497120.83168468962,298872.29504339921,332493.39190069411,386982.75577286165,332493.39190069411,323218.60656075069],"mode":"lines","name":"Luus-Jaakola","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[140,35,132,212,225,60,135,200,110,200,83,220,220,146,100,180,123,95,250,320,278,251,251,251,87,91,112,132,132,215,250,251,168,200,90,160,251,160,251,251,321,150,200,240,212,172,160,180,251,251,251,172,330,200,137,251,60,178,123,325,251,332,310,139,168,215,168,160],"y":[285193.52157162974,153499.76063813086,275159.71121479175,375497.81478317181,391802.75661303359,184855.41800324962,278922.390098606,360447.09924791486,247566.73273348721,360447.09924791486,213702.62277915893,385531.62514000986,385531.62514000986,292718.87933925824,235024.46978743968,335362.5733558198,263871.67456334899,228753.33831441595,423158.41397815238,510954.25460048497,458276.75022708543,424412.64027275715,424412.64027275715,424412.64027275715,218719.52795757793,223736.43313599692,250075.18532269669,275159.71121479175,275159.71121479175,379260.49366698606,423158.41397815238,424412.64027275715,320311.85782056279,360447.09924791486,222482.20684139218,310278.04746372474,424412.64027275715,310278.04746372474,424412.64027275715,424412.64027275715,512208.48089508974,297735.78451767727,360447.09924791486,410616.15103210486,375497.81478317181,325328.76299898175,310278.04746372474,335362.5733558198,424412.64027275715,424412.64027275715,424412.64027275715,325328.76299898175,523496.5175465325,360447.09924791486,281430.84268781549,424412.64027275715,184855.41800324962,332854.12076661026,263871.67456334899,517225.38607350871,424412.64027275715,526004.97013574198,498411.99165443744,283939.29527702497,320311.85782056279,379260.49366698606,320311.85782056279,310278.04746372474],"mode":"lines","name":"Gradiente Descendente","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Podemos observar que el modelo lineal ajusta razonablemente bien los datos, capturando la tendencia general de incremento del precio con la superficie cubierta.</p>
<p>Para validar y contrastar nuestros resultados, utilizaremos la función nativa lm() de R para ajustar un modelo lineal y comparar los coeficientes obtenidos.</p>
<section id="ajuste-del-modelo-lineal-con-lm" class="level4" data-number="4.0.1">
<h4 data-number="4.0.1" class="anchored" data-anchor-id="ajuste-del-modelo-lineal-con-lm"><span class="header-section-number">4.0.1</span> Ajuste del Modelo Lineal con lm()</h4>
<p>La función lm() en R realiza un ajuste de mínimos cuadrados ordinarios (OLS), proporcionando una solución analítica al problema de regresión lineal.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste del modelo lineal utilizando lm()</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>modelo_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Precio <span class="sc">~</span> Sup, <span class="at">data =</span> data)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Precio ~ Sup, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-217225  -49083     603   75104  190740 

Coefficients:
            Estimate Std. Error t value        Pr(&gt;|t|)    
(Intercept) 109601.8    32593.3   3.363         0.00129 ** 
Sup           1254.2      160.6   7.808 0.0000000000583 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 94100 on 66 degrees of freedom
Multiple R-squared:  0.4802,    Adjusted R-squared:  0.4723 
F-statistic: 60.97 on 1 and 66 DF,  p-value: 0.00000000005832</code></pre>
</div>
</div>
<p>El resumen del modelo proporciona los coeficientes estimados:</p>
<ul>
<li><span class="math inline">\(\mu =\)</span> 109601.84</li>
<li><span class="math inline">\(\alpha =\)</span> 1254.23</li>
</ul>
<p>Los valores son:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtener los coeficientes del modelo lm</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>mu_lm <span class="ot">&lt;-</span> modelo_lm<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>alpha_lm <span class="ot">&lt;-</span> modelo_lm<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un data frame con los valores</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>coeficientes_lm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  Parámetro <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Mu"</span>, <span class="st">"Alpha"</span>),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valor =</span> <span class="fu">c</span>(<span class="fu">round</span>(mu_lm, <span class="dv">2</span>), <span class="fu">round</span>(alpha_lm, <span class="dv">2</span>))</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar la tabla usando knitr::kable</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(coeficientes_lm, <span class="at">caption =</span> <span class="st">"Valores obtenidos con lm()"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Valores obtenidos con lm()</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Parámetro</th>
<th style="text-align: right;">Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: left;">Mu</td>
<td style="text-align: right;">109601.84</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sup</td>
<td style="text-align: left;">Alpha</td>
<td style="text-align: right;">1254.23</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="comparación-de-predicciones" class="level4" data-number="4.0.2">
<h4 data-number="4.0.2" class="anchored" data-anchor-id="comparación-de-predicciones"><span class="header-section-number">4.0.2</span> Comparación de Predicciones</h4>
<p>Para visualizar el ajuste de los modelos, graficamos las predicciones obtenidas con cada método junto con los datos reales:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones con los parámetros finales</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>preds_lj <span class="ot">&lt;-</span> mu_lj <span class="sc">+</span> alpha_lj <span class="sc">*</span> data<span class="sc">$</span>Sup</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>preds_gd <span class="ot">&lt;-</span> mu_gd <span class="sc">+</span> alpha_gd <span class="sc">*</span> data<span class="sc">$</span>Sup</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>preds_lm <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_lm, data)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de comparación</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(data, <span class="at">x =</span> <span class="sc">~</span>Sup, <span class="at">y =</span> <span class="sc">~</span>Precio, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'markers'</span>, <span class="at">name =</span> <span class="st">'Datos Reales'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>Sup, <span class="at">y =</span> preds_lj, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Luus-Jaakola'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'red'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>Sup, <span class="at">y =</span> preds_gd, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Gradiente Descendente'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'green'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>Sup, <span class="at">y =</span> preds_lm, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'lm()'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'blue'</span>, <span class="at">dash =</span> <span class="st">'dash'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Ajuste del Modelo Lineal con Diferentes Métodos'</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Superficie Cubierta (Sup)'</span>),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Precio'</span>),</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fl">0.1</span>, <span class="at">y =</span> <span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7531f021030c44f57ef2" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7531f021030c44f57ef2">{"x":{"visdat":{"672c3a29234a":["function () ","plotlyVisDat"]},"cur_data":"672c3a29234a","attrs":{"672c3a29234a":{"x":{},"y":{},"mode":"markers","name":"Datos Reales","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"672c3a29234a.1":{"x":{},"y":[300031.64321089216,178300.0856241349,290756.85787094873,383504.71127038286,398576.23744779092,207283.78981145803,294234.90237342753,369592.53326046775,265251.19818610436,369592.53326046775,233948.79766379535,392779.49661032629,392779.49661032629,306987.73221584974,253657.71651117509,346405.56991060922,280322.72436351242,247860.97567371046,427559.94163511402,508714.31335961889,460021.69032491604,428719.28980260703,428719.28980260703,428719.28980260703,238586.19033376707,243223.58300373878,267569.8945210902,290756.85787094873,290756.85787094873,386982.75577286165,427559.94163511402,428719.28980260703,332493.39190069411,369592.53326046775,242064.23483624583,323218.60656075069,428719.28980260703,323218.60656075069,428719.28980260703,428719.28980260703,509873.66152711189,311625.12488582142,369592.53326046775,415966.45996018476,383504.71127038286,337130.7845706658,323218.60656075069,346405.56991060922,428719.28980260703,428719.28980260703,428719.28980260703,337130.7845706658,520307.79503454815,369592.53326046775,296553.59870841342,428719.28980260703,207283.78981145803,344086.87357562338,280322.72436351242,514511.05419708358,428719.28980260703,522626.49136953405,497120.83168468962,298872.29504339921,332493.39190069411,386982.75577286165,332493.39190069411,323218.60656075069],"mode":"lines","name":"Luus-Jaakola","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","line":{"color":"red"},"inherit":true},"672c3a29234a.2":{"x":{},"y":[285193.52157162974,153499.76063813086,275159.71121479175,375497.81478317181,391802.75661303359,184855.41800324962,278922.390098606,360447.09924791486,247566.73273348721,360447.09924791486,213702.62277915893,385531.62514000986,385531.62514000986,292718.87933925824,235024.46978743968,335362.5733558198,263871.67456334899,228753.33831441595,423158.41397815238,510954.25460048497,458276.75022708543,424412.64027275715,424412.64027275715,424412.64027275715,218719.52795757793,223736.43313599692,250075.18532269669,275159.71121479175,275159.71121479175,379260.49366698606,423158.41397815238,424412.64027275715,320311.85782056279,360447.09924791486,222482.20684139218,310278.04746372474,424412.64027275715,310278.04746372474,424412.64027275715,424412.64027275715,512208.48089508974,297735.78451767727,360447.09924791486,410616.15103210486,375497.81478317181,325328.76299898175,310278.04746372474,335362.5733558198,424412.64027275715,424412.64027275715,424412.64027275715,325328.76299898175,523496.5175465325,360447.09924791486,281430.84268781549,424412.64027275715,184855.41800324962,332854.12076661026,263871.67456334899,517225.38607350871,424412.64027275715,526004.97013574198,498411.99165443744,283939.29527702497,320311.85782056279,379260.49366698606,320311.85782056279,310278.04746372474],"mode":"lines","name":"Gradiente Descendente","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","line":{"color":"green"},"inherit":true},"672c3a29234a.3":{"x":{},"y":[285193.52142894379,153499.76019624464,275159.71104930958,375497.81484565174,391802.7567125574,184855.41763260157,278922.38994167239,360447.0992762004,247566.73250531545,360447.0992762004,213702.62247404997,385531.625225286,385531.625225286,292718.87921366945,235024.46953077268,335362.57332711492,263871.67437222105,228753.33804350131,423158.41414891428,510954.25497071375,458276.75047763414,424412.6404463686,424412.6404463686,424412.6404463686,218719.52766386708,223736.43285368418,250075.18510022401,275159.71104930958,275159.71104930958,379260.4937380146,423158.41414891428,424412.6404463686,320311.85775766359,360447.0992762004,222482.20655622991,310278.04737802933,424412.6404463686,310278.04737802933,424412.6404463686,424412.6404463686,512208.48126816796,297735.78440348653,360447.0992762004,410616.15117437148,375497.81484565174,325328.76294748066,310278.04737802933,335362.57332711492,424412.6404463686,424412.6404463686,424412.6404463686,325328.76294748066,523496.51794525655,360447.0992762004,281430.84253658098,424412.6404463686,184855.41763260157,332854.12073220633,263871.67437222105,517225.38645798515,424412.6404463686,526004.97054016509,498411.99199617095,283939.29513148952,320311.85775766359,379260.4937380146,320311.85775766359,310278.04737802933],"mode":"lines","name":"lm()","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","line":{"color":"blue","dash":"dash"},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Ajuste del Modelo Lineal con Diferentes Métodos","xaxis":{"domain":[0,1],"automargin":true,"title":"Superficie Cubierta (Sup)"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Precio"},"legend":{"x":0.10000000000000001,"y":0.90000000000000002},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[140,35,132,212,225,60,135,200,110,200,83,220,220,146,100,180,123,95,250,320,278,251,251,251,87,91,112,132,132,215,250,251,168,200,90,160,251,160,251,251,321,150,200,240,212,172,160,180,251,251,251,172,330,200,137,251,60,178,123,325,251,332,310,139,168,215,168,160],"y":[215000,90000,239000,394900,480000,175000,250000,275000,165000,175000,225000,295000,450000,345000,295000,315000,290000,297000,450000,425000,290000,540000,540000,540000,177000,360000,190000,239000,229000,450000,379000,540000,295000,185000,243000,409000,540000,265000,540000,540000,300000,325000,175000,347000,394900,360000,265000,290000,540000,540000,540000,360000,425000,250000,325000,540000,145000,275000,290000,300000,540000,490000,590000,295000,295000,570000,295000,265000],"mode":"markers","name":"Datos Reales","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[140,35,132,212,225,60,135,200,110,200,83,220,220,146,100,180,123,95,250,320,278,251,251,251,87,91,112,132,132,215,250,251,168,200,90,160,251,160,251,251,321,150,200,240,212,172,160,180,251,251,251,172,330,200,137,251,60,178,123,325,251,332,310,139,168,215,168,160],"y":[300031.64321089216,178300.0856241349,290756.85787094873,383504.71127038286,398576.23744779092,207283.78981145803,294234.90237342753,369592.53326046775,265251.19818610436,369592.53326046775,233948.79766379535,392779.49661032629,392779.49661032629,306987.73221584974,253657.71651117509,346405.56991060922,280322.72436351242,247860.97567371046,427559.94163511402,508714.31335961889,460021.69032491604,428719.28980260703,428719.28980260703,428719.28980260703,238586.19033376707,243223.58300373878,267569.8945210902,290756.85787094873,290756.85787094873,386982.75577286165,427559.94163511402,428719.28980260703,332493.39190069411,369592.53326046775,242064.23483624583,323218.60656075069,428719.28980260703,323218.60656075069,428719.28980260703,428719.28980260703,509873.66152711189,311625.12488582142,369592.53326046775,415966.45996018476,383504.71127038286,337130.7845706658,323218.60656075069,346405.56991060922,428719.28980260703,428719.28980260703,428719.28980260703,337130.7845706658,520307.79503454815,369592.53326046775,296553.59870841342,428719.28980260703,207283.78981145803,344086.87357562338,280322.72436351242,514511.05419708358,428719.28980260703,522626.49136953405,497120.83168468962,298872.29504339921,332493.39190069411,386982.75577286165,332493.39190069411,323218.60656075069],"mode":"lines","name":"Luus-Jaakola","type":"scatter","line":{"color":"red"},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[140,35,132,212,225,60,135,200,110,200,83,220,220,146,100,180,123,95,250,320,278,251,251,251,87,91,112,132,132,215,250,251,168,200,90,160,251,160,251,251,321,150,200,240,212,172,160,180,251,251,251,172,330,200,137,251,60,178,123,325,251,332,310,139,168,215,168,160],"y":[285193.52157162974,153499.76063813086,275159.71121479175,375497.81478317181,391802.75661303359,184855.41800324962,278922.390098606,360447.09924791486,247566.73273348721,360447.09924791486,213702.62277915893,385531.62514000986,385531.62514000986,292718.87933925824,235024.46978743968,335362.5733558198,263871.67456334899,228753.33831441595,423158.41397815238,510954.25460048497,458276.75022708543,424412.64027275715,424412.64027275715,424412.64027275715,218719.52795757793,223736.43313599692,250075.18532269669,275159.71121479175,275159.71121479175,379260.49366698606,423158.41397815238,424412.64027275715,320311.85782056279,360447.09924791486,222482.20684139218,310278.04746372474,424412.64027275715,310278.04746372474,424412.64027275715,424412.64027275715,512208.48089508974,297735.78451767727,360447.09924791486,410616.15103210486,375497.81478317181,325328.76299898175,310278.04746372474,335362.5733558198,424412.64027275715,424412.64027275715,424412.64027275715,325328.76299898175,523496.5175465325,360447.09924791486,281430.84268781549,424412.64027275715,184855.41800324962,332854.12076661026,263871.67456334899,517225.38607350871,424412.64027275715,526004.97013574198,498411.99165443744,283939.29527702497,320311.85782056279,379260.49366698606,320311.85782056279,310278.04746372474],"mode":"lines","name":"Gradiente Descendente","type":"scatter","line":{"color":"green"},"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[140,35,132,212,225,60,135,200,110,200,83,220,220,146,100,180,123,95,250,320,278,251,251,251,87,91,112,132,132,215,250,251,168,200,90,160,251,160,251,251,321,150,200,240,212,172,160,180,251,251,251,172,330,200,137,251,60,178,123,325,251,332,310,139,168,215,168,160],"y":[285193.52142894379,153499.76019624464,275159.71104930958,375497.81484565174,391802.7567125574,184855.41763260157,278922.38994167239,360447.0992762004,247566.73250531545,360447.0992762004,213702.62247404997,385531.625225286,385531.625225286,292718.87921366945,235024.46953077268,335362.57332711492,263871.67437222105,228753.33804350131,423158.41414891428,510954.25497071375,458276.75047763414,424412.6404463686,424412.6404463686,424412.6404463686,218719.52766386708,223736.43285368418,250075.18510022401,275159.71104930958,275159.71104930958,379260.4937380146,423158.41414891428,424412.6404463686,320311.85775766359,360447.0992762004,222482.20655622991,310278.04737802933,424412.6404463686,310278.04737802933,424412.6404463686,424412.6404463686,512208.48126816796,297735.78440348653,360447.0992762004,410616.15117437148,375497.81484565174,325328.76294748066,310278.04737802933,335362.57332711492,424412.6404463686,424412.6404463686,424412.6404463686,325328.76294748066,523496.51794525655,360447.0992762004,281430.84253658098,424412.6404463686,184855.41763260157,332854.12073220633,263871.67437222105,517225.38645798515,424412.6404463686,526004.97054016509,498411.99199617095,283939.29513148952,320311.85775766359,379260.4937380146,320311.85775766359,310278.04737802933],"mode":"lines","name":"lm()","type":"scatter","line":{"color":"blue","dash":"dash"},"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><br> Como las tres líneas prácticamente se superponen, indican que todos los métodos proporcionan un ajuste muy similar. Destacamos que el método LM() y la optimización por gradiente descendente llegaron a exactamente el mismo resultado.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Comparación de coeficientes obtenidos con diferentes métodos</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Método</th>
<th style="text-align: right;">Mu</th>
<th style="text-align: right;">Alpha</th>
<th style="text-align: right;">MSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Luus-Jaakola</td>
<td style="text-align: right;">137722.9</td>
<td style="text-align: right;">1159.35</td>
<td style="text-align: right;">8740642890</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gradiente Descendente</td>
<td style="text-align: right;">109601.8</td>
<td style="text-align: right;">1254.23</td>
<td style="text-align: right;">8593462003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lm()</td>
<td style="text-align: right;">109601.8</td>
<td style="text-align: right;">1254.23</td>
<td style="text-align: right;">8593462003</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br> Podemos observar que los valores obtenidos con nuestros métodos de optimización numérica son muy cercanos a los obtenidos con la solución analítica de <strong>lm()</strong>, lo que valida la eficacia de los algoritmos implementados.</p>
</section>
</section>
<section id="conclusiones" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="conclusiones"><span class="header-section-number">5</span> Conclusiones</h2>
<p>En este trabajo, hemos aplicado modelos lineales y algoritmos de optimización para predecir el precio de venta de casas en el barrio de Boedo, en base a la superficie cubierta.</p>
<p>Utilizamos dos métodos de optimización: <strong>Luus-Jaakola</strong> y <strong>gradiente descendente</strong>. Ambos métodos convergieron a soluciones similares, confirmando la efectividad de estos algoritmos en la optimización de funciones convexas.</p>
<p>El modelo lineal simple utilizado demostró ser adecuado para capturar la relación entre la superficie cubierta y el precio. Sin embargo, para mejorar el modelo, podríamos considerar incluir otras variables, como el fondo, la cantidad de habitaciones, o características del barrio.</p>
</section>
<section id="apendice" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="apendice"><span class="header-section-number">6</span> Apendice</h2>
<p>Bibliografia</p>
<p><a href="https://www.properati.com.ar/">[1]</a> Properati, Sitio Web de Properati</p>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb17" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Análisis de Modelos Lineales y Algoritmos de Optimización en Datos de Propiedades"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Lorenzo Marquesini, Agustín Orue, Juan Cruz Chierasco, Marco Di Sario"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: flatly</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-align: center</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="an">fontsize:</span><span class="co"> 16pt</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, output = FALSE, warning = FALSE, message = FALSE}</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="in"># Carga de Librerías}</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="in">library(plotly)</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="in"># Carga de Datos</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="in">data &lt;- read_csv("data/ar_properties.csv")</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="in"># Selección de datos</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="in">data &lt;- data %&gt;%</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="in">    l1 == "Argentina", </span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="in">    l2 == "Capital Federal", </span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="in">    l3 == "Boedo",</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="in">    currency == "USD",</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="in">    property_type == "Casa",</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="in">    operation_type == "Venta"</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="in">    Sup = surface_covered,</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="in">    Fondo = surface_total - surface_covered,</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="in">    Precio = price</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(Fondo &gt;= 0) %&gt;%</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="in">  na.omit()</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="in">options(scipen=999)</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## Resumen</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>En este trabajo analizamos el uso de modelos lineales y algoritmos de optimización aplicados a un conjunto de datos de propiedades inmobiliarias del barrio de Boedo, en la Ciudad de Buenos Aires. Se busca entender cómo la superficie cubierta (Sup) influye en el precio (Precio) de venta de las casas. Utilizaremos métodos de optimización como Luus-Jaakola y gradiente descendente para ajustar un modelo lineal a los datos.</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduccion</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>Utilizaremos un subconjunto del dataset real de publicaciones digitales de inmuebles, provisto en forma libre por Properati <span class="co">[</span><span class="ot">\[1\]</span><span class="co">](https://www.properati.com.ar/ "properati.com.ar")</span>.</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">as.data.frame</span>(data))</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>En este caso contamos con 68 casas del barrio de Boedo, con precios en dólares que van desde los u\$s 90000 hasta los u\$s 600000. Se plantea un resumen de estos datos en el próximo gráfico.</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(data)</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>Puede observarse que tanto la superficie cubierta (Sup) como el fondo (Fondo) están positivamente correlacionados con el precio (Precio). Asimismo, también se aprecia una correlación positiva entre Sup y Fondo.</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a><span class="fu">## Teoria</span></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Un Modelo es una explicitación simplifcada de algunas relaciones potencialmente existentes entre las variables disponibles</span></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>Dividimos el trabajo con el modelo en 3 etapas principales:</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Representación</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Evaluación</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Optimización</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a><span class="fu">### Representación - "El Modelo en si mismo"</span></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>Proponemos un modelo lineal sencillo que relaciona el precio con la superficie cubierta:</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>h_0 = \mu + \alpha * Sup</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>Donde: - $h_0$ es la predicción del precio. - $\mu$ es el término independiente. - $\alpha$ es el coeficiente que multiplica a la superficie cubierta (Sup).</span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>El modelo recién planteado puede pensarse como una función, que dados los parámetros θ = (µ, α), asigna un precio a una combinación cualquiera de valores de superficie. Entonces</span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>Precio^{m2} = F_{\mu, \alpha}(Sup)</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a><span class="fu">### Evaluación - "Medida de falta de ajuste"</span></span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>Utilizamos el error cuadrático medio (MSE) como función de pérdida para evaluar el ajuste del modelo:</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>\frac{1}{68} \sum_{i=1}^{68} (Precio_i - (\mu + \alpha * Sup))^2 </span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>Donde: - $n$ es el número de observaciones (en este caso, 68). - $Precio_i$ es el precio real de la observación $i$. - $Sup_i$ es la superficie cubierta de la observación $i$.</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Funciones de perdida Alternativas</span></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>Además del MSE, existen otras funciones de pérdida que pueden ser utilizadas, cada una con sus pros y contras:</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>| Función de Pérdida | Pros | Contras |</span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>|------------------|-------------------------|-----------------------------|</span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>| Error Absoluto Medio (MAE) | Menos sensible a valores atípicos | Puede ser menos eficiente en términos estadísticos |</span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>| Error Cuadrático Medio (MSE) | Penaliza más los errores grandes | Sensible a valores atípicos |</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>| Error Logarítmico | Útil para datos con crecimiento exponencial | No está definido para valores cero o negativos |</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a><span class="fu">### Optimización - "Etapa de entrenamiento"</span></span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>La tarea de optimización consiste en, dadas la representación y la evaluación elegidas, definir un procedimiento efectivo que pueda hallar la determinación óptima de los parámetros del modelo, es decir, la determinación de parámetros que produzcan la menor falta de ajuste posible.</span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>En este caso particular, el problema de optimización planteado puede resolverse analíticamente mediante mínimos cuadrados ordinarios (OLS). Sin embargo, utilizaremos métodos numéricos para ilustrar su aplicación en casos donde la solución analítica no es viable.</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a>En modelos más complejos o no lineales, la función de pérdida puede no ser convexa o no tener una solución cerrada, lo que hace necesario el uso de métodos numéricos de optimización, no se puede resolver analíticamente.</span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>Vamos a aplicar dos mecanismos básicos de optimización:</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Luus-Jaakola - Optimización Aleatoria</span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Gradiente Descendente</span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Luus-Jaakola - Optimización Aleatoria</span></span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>El método Luus-Jaakola es un algoritmo de optimización estocástica que no requiere información sobre el gradiente de la función objetivo. Consiste en:</span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Inicializar los parámetros con valores arbitrarios.</span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>En cada iteración, generar nuevos candidatos alrededor de los mejores parámetros actuales, dentro de una región de búsqueda que se va reduciendo.</span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Si un nuevo candidato mejora la función objetivo, se actualizan los parámetros.</span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Repetir hasta convergencia o hasta alcanzar un número máximo de iteraciones.</span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a>Implementamos el método Luus-Jaakola de la siguiente manera:</span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a><span class="co"># Estandarizar variables</span></span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a>mean_sup <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Sup)</span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a>sd_sup <span class="ot">&lt;-</span> <span class="fu">sd</span>(data<span class="sc">$</span>Sup)</span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a>mean_precio <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Precio)</span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a>sd_precio <span class="ot">&lt;-</span> <span class="fu">sd</span>(data<span class="sc">$</span>Precio)</span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Sup_scaled <span class="ot">&lt;-</span> (data<span class="sc">$</span>Sup <span class="sc">-</span> mean_sup) <span class="sc">/</span> sd_sup</span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Precio_scaled <span class="ot">&lt;-</span> (data<span class="sc">$</span>Precio <span class="sc">-</span> mean_precio) <span class="sc">/</span> sd_precio</span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a><span class="co"># Inicialización</span></span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a>mu_lj <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a>alpha_lj <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a>best_loss <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)  <span class="co"># Tamaño inicial de la región de búsqueda</span></span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a>n_iter <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Vectores para almacenar la evolución</span></span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a>mu_history <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a>alpha_history <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a>loss_history <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_iter) {</span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generar nuevos candidatos</span></span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a>  mu_candidate <span class="ot">&lt;-</span> mu_lj <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span>delta[<span class="dv">1</span>], delta[<span class="dv">1</span>])</span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a>  alpha_candidate <span class="ot">&lt;-</span> alpha_lj <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span>delta[<span class="dv">2</span>], delta[<span class="dv">2</span>])</span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcular pérdida en escala estandarizada</span></span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a>  preds_scaled <span class="ot">&lt;-</span> mu_candidate <span class="sc">+</span> alpha_candidate <span class="sc">*</span> data<span class="sc">$</span>Sup_scaled</span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a>  loss <span class="ot">&lt;-</span> <span class="fu">mean</span>((data<span class="sc">$</span>Precio_scaled <span class="sc">-</span> preds_scaled)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Actualizar si mejora</span></span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (loss <span class="sc">&lt;</span> best_loss) {</span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a>    mu_lj <span class="ot">&lt;-</span> mu_candidate</span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a>    alpha_lj <span class="ot">&lt;-</span> alpha_candidate</span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a>    best_loss <span class="ot">&lt;-</span> loss</span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reducir región de búsqueda</span></span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a>    delta <span class="ot">&lt;-</span> delta <span class="sc">*</span> <span class="fl">0.95</span></span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Aumentar región de búsqueda ligeramente</span></span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a>    delta <span class="ot">&lt;-</span> delta <span class="sc">*</span> <span class="fl">1.05</span></span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Almacenar historia</span></span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a>  mu_history[i] <span class="ot">&lt;-</span> mu_lj</span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a>  alpha_history[i] <span class="ot">&lt;-</span> alpha_lj</span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a>  loss_history[i] <span class="ot">&lt;-</span> best_loss</span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-197"><a href="#cb17-197" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir parámetros a escala original</span></span>
<span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a>alpha_lj <span class="ot">&lt;-</span> alpha_lj <span class="sc">*</span> (sd_precio <span class="sc">/</span> sd_sup)</span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a>mu_lj <span class="ot">&lt;-</span> (mu_lj <span class="sc">*</span> sd_precio <span class="sc">+</span> mean_precio) <span class="sc">-</span> alpha_lj <span class="sc">*</span> mean_sup</span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a><span class="co"># Almacenar historia de parámetros en escala original para visualización</span></span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a>alpha_history <span class="ot">&lt;-</span> alpha_history <span class="sc">*</span> (sd_precio <span class="sc">/</span> sd_sup)</span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a>mu_history <span class="ot">&lt;-</span> (mu_history <span class="sc">*</span> sd_precio <span class="sc">+</span> mean_precio) <span class="sc">-</span> alpha_history <span class="sc">*</span> mean_sup</span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a>Empecemos viendo la evolución de la cantidad de iteraciones en función de la cantidad de actualizaciones (modificación del óptimo hasta ese momento) a lo largo del proceso.</span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>n_iter, <span class="at">y =</span> loss_history, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Pérdida'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Evolución de la Pérdida con Luus-Jaakola'</span>,</span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Iteración'</span>),</span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Pérdida'</span>))</span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a>El siguiente gráfico muestra la evolución de los mejores parámetros obtenidos a lo largo del proceso</span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a><span class="fu">## Evolución de Mu</span></span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE}</span></span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a><span class="in">df_params &lt;- data.frame(</span></span>
<span id="cb17-225"><a href="#cb17-225" aria-hidden="true" tabindex="-1"></a><span class="in">  Iteración = 1:n_iter,</span></span>
<span id="cb17-226"><a href="#cb17-226" aria-hidden="true" tabindex="-1"></a><span class="in">  Mu = mu_history,</span></span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a><span class="in">  Alpha = alpha_history</span></span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a><span class="in"># Gráfico de la evolución de Mu</span></span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a><span class="in">plot_mu &lt;- plot_ly(df_params, x = ~Iteración, y = ~Mu, type = 'scatter', mode = 'lines', name = 'Mu') %&gt;%</span></span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a><span class="in">  layout(title = 'Evolución de Mu con Luus-Jaakola',</span></span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a><span class="in">         xaxis = list(title = 'Iteración'),</span></span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a><span class="in">         yaxis = list(title = 'Mu'))</span></span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a><span class="in"># Gráfico de la evolución de Alpha</span></span>
<span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a><span class="in">plot_alpha &lt;- plot_ly(df_params, x = ~Iteración, y = ~Alpha, type = 'scatter', mode = 'lines', color= "orange", name = 'Alpha') %&gt;%</span></span>
<span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a><span class="in">  layout(title = 'Evolución de Alpha con Luus-Jaakola',</span></span>
<span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a><span class="in">         xaxis = list(title = 'Iteración'),</span></span>
<span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a><span class="in">         yaxis = list(title = 'Alpha'))</span></span>
<span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a><span class="in"># Mostrar los gráficos por separado</span></span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a><span class="in">plot_mu</span></span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a><span class="fu">## Evolución de Alpha</span></span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE}</span></span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a><span class="in">plot_alpha</span></span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a>Se ve claramente que la evolución de cada uno de los dos parámetros converge a un valor final, a los que podemos considerar como las estimaciones. Estos valores finales son:</span>
<span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-255"><a href="#cb17-255" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\mu =$ <span class="in">`r mu_lj`</span></span>
<span id="cb17-256"><a href="#cb17-256" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\alpha =$ <span class="in">`r alpha_lj`</span></span>
<span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gradiente Descendente</span></span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a>El método del gradiente descendente consiste en actualizar los parámetros en la dirección opuesta al gradiente de la función de pérdida. El algoritmo es el siguiente:</span>
<span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Inicializar los parámetros con valores aleatorios.</span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Calcular el gradiente de la función de pérdida con respecto a los parámetros.</span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Actualizar los parámetros en la dirección opuesta al gradiente. $$</span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a>    \theta_{t+1} = \theta_t - \lambda \nabla L</span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a>    $$ Donde $\lambda$ es la tasa de aprendizaje (learning rate) y $\nabla L(\theta_t)$ es el gradiente de la función de pérdida $L$ con respecto a los parámetros $\theta$ en el paso $t$.</span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Repetir hasta convergencia.</span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-272"><a href="#cb17-272" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Convergencia: La convergencia se produce cuando un modelo ha alcanzado un estado en el que ya no mejora significativamente su rendimiento con más iteraciones o entrenamiento.</span></span>
<span id="cb17-273"><a href="#cb17-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-274"><a href="#cb17-274" aria-hidden="true" tabindex="-1"></a>Existen diferentes variantes del gradiente descendente: <span class="sc">\*</span> **Gradiente Descendente por Lotes (Batch Gradient Descent)**: Utiliza todo el conjunto de datos para calcular el gradiente en cada paso. Es estable pero puede ser lento en conjuntos de datos grandes.</span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Gradiente Descendente Estocástico (Stochastic Gradient Descent, SGD)**: Actualiza los parámetros usando una sola muestra a la vez. Es más rápido pero introduce ruido en la estimación del gradiente, lo que puede dificultar la convergencia.</span>
<span id="cb17-277"><a href="#cb17-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-278"><a href="#cb17-278" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Gradiente Descendente Mini-Batch**: Compromiso entre los dos anteriores. Usa un subconjunto (mini-batch) de muestras para calcular el gradiente en cada paso. Balancea eficiencia computacional y estabilidad en la convergencia.</span>
<span id="cb17-279"><a href="#cb17-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a>En este caso, implementaremos el gradiente descendente por lotes, utilizando todo el conjunto de datos en cada iteración.</span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a><span class="co"># Estandarizar variables</span></span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a>mean_sup <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Sup)</span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a>sd_sup <span class="ot">&lt;-</span> <span class="fu">sd</span>(data<span class="sc">$</span>Sup)</span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a>mean_precio <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Precio)</span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a>sd_precio <span class="ot">&lt;-</span> <span class="fu">sd</span>(data<span class="sc">$</span>Precio)</span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Sup_scaled <span class="ot">&lt;-</span> (data<span class="sc">$</span>Sup <span class="sc">-</span> mean_sup) <span class="sc">/</span> sd_sup</span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Precio_scaled <span class="ot">&lt;-</span> (data<span class="sc">$</span>Precio <span class="sc">-</span> mean_precio) <span class="sc">/</span> sd_precio</span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a><span class="co"># Inicialización de parámetros</span></span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a>mu_gd <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a>alpha_gd <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a>learning_rate <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a>n_iter_gd <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb17-300"><a href="#cb17-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-301"><a href="#cb17-301" aria-hidden="true" tabindex="-1"></a><span class="co"># Vectores para almacenar la evolución</span></span>
<span id="cb17-302"><a href="#cb17-302" aria-hidden="true" tabindex="-1"></a>mu_history_gd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter_gd)</span>
<span id="cb17-303"><a href="#cb17-303" aria-hidden="true" tabindex="-1"></a>alpha_history_gd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter_gd)</span>
<span id="cb17-304"><a href="#cb17-304" aria-hidden="true" tabindex="-1"></a>loss_history_gd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter_gd)</span>
<span id="cb17-305"><a href="#cb17-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-306"><a href="#cb17-306" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_iter_gd) {</span>
<span id="cb17-307"><a href="#cb17-307" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predicciones usando variables escaladas</span></span>
<span id="cb17-308"><a href="#cb17-308" aria-hidden="true" tabindex="-1"></a>  preds_scaled <span class="ot">&lt;-</span> mu_gd <span class="sc">+</span> alpha_gd <span class="sc">*</span> data<span class="sc">$</span>Sup_scaled</span>
<span id="cb17-309"><a href="#cb17-309" aria-hidden="true" tabindex="-1"></a>  errors <span class="ot">&lt;-</span> preds_scaled <span class="sc">-</span> data<span class="sc">$</span>Precio_scaled</span>
<span id="cb17-310"><a href="#cb17-310" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-311"><a href="#cb17-311" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcular gradientes</span></span>
<span id="cb17-312"><a href="#cb17-312" aria-hidden="true" tabindex="-1"></a>  mu_grad <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">/</span> <span class="fu">nrow</span>(data)) <span class="sc">*</span> <span class="fu">sum</span>(errors)</span>
<span id="cb17-313"><a href="#cb17-313" aria-hidden="true" tabindex="-1"></a>  alpha_grad <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">/</span> <span class="fu">nrow</span>(data)) <span class="sc">*</span> <span class="fu">sum</span>(errors <span class="sc">*</span> data<span class="sc">$</span>Sup_scaled)</span>
<span id="cb17-314"><a href="#cb17-314" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-315"><a href="#cb17-315" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Actualizar parámetros</span></span>
<span id="cb17-316"><a href="#cb17-316" aria-hidden="true" tabindex="-1"></a>  mu_gd <span class="ot">&lt;-</span> mu_gd <span class="sc">-</span> learning_rate <span class="sc">*</span> mu_grad</span>
<span id="cb17-317"><a href="#cb17-317" aria-hidden="true" tabindex="-1"></a>  alpha_gd <span class="ot">&lt;-</span> alpha_gd <span class="sc">-</span> learning_rate <span class="sc">*</span> alpha_grad</span>
<span id="cb17-318"><a href="#cb17-318" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-319"><a href="#cb17-319" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcular pérdida</span></span>
<span id="cb17-320"><a href="#cb17-320" aria-hidden="true" tabindex="-1"></a>  loss <span class="ot">&lt;-</span> <span class="fu">mean</span>(errors<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-321"><a href="#cb17-321" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-322"><a href="#cb17-322" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Almacenar historia</span></span>
<span id="cb17-323"><a href="#cb17-323" aria-hidden="true" tabindex="-1"></a>  mu_history_gd[i] <span class="ot">&lt;-</span> mu_gd</span>
<span id="cb17-324"><a href="#cb17-324" aria-hidden="true" tabindex="-1"></a>  alpha_history_gd[i] <span class="ot">&lt;-</span> alpha_gd</span>
<span id="cb17-325"><a href="#cb17-325" aria-hidden="true" tabindex="-1"></a>  loss_history_gd[i] <span class="ot">&lt;-</span> loss</span>
<span id="cb17-326"><a href="#cb17-326" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-327"><a href="#cb17-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-328"><a href="#cb17-328" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir parámetros a escala original</span></span>
<span id="cb17-329"><a href="#cb17-329" aria-hidden="true" tabindex="-1"></a>alpha_gd <span class="ot">&lt;-</span> alpha_gd <span class="sc">*</span> (sd_precio <span class="sc">/</span> sd_sup)</span>
<span id="cb17-330"><a href="#cb17-330" aria-hidden="true" tabindex="-1"></a>mu_gd <span class="ot">&lt;-</span> (mu_gd <span class="sc">*</span> sd_precio <span class="sc">+</span> mean_precio) <span class="sc">-</span> alpha_gd <span class="sc">*</span> mean_sup</span>
<span id="cb17-331"><a href="#cb17-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a><span class="co"># Almacenar historia de parámetros en escala original para visualización</span></span>
<span id="cb17-333"><a href="#cb17-333" aria-hidden="true" tabindex="-1"></a>alpha_history_gd <span class="ot">&lt;-</span> alpha_history_gd <span class="sc">*</span> (sd_precio <span class="sc">/</span> sd_sup)</span>
<span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a>intercept_history_gd <span class="ot">&lt;-</span> (mu_history_gd <span class="sc">*</span> sd_precio <span class="sc">+</span> mean_precio) <span class="sc">-</span> alpha_history_gd <span class="sc">*</span> mean_sup</span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a>Visualizamos la evolución de la pérdida:</span>
<span id="cb17-338"><a href="#cb17-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-341"><a href="#cb17-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadir puntos a cada iteración</span></span>
<span id="cb17-343"><a href="#cb17-343" aria-hidden="true" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n_iter_gd</span>
<span id="cb17-344"><a href="#cb17-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-345"><a href="#cb17-345" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> iterations, <span class="at">y =</span> loss_history_gd, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, <span class="at">name =</span> <span class="st">'Pérdida'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-346"><a href="#cb17-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Evolución de la Pérdida con Gradiente Descendente'</span>,</span>
<span id="cb17-347"><a href="#cb17-347" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Iteración'</span>),</span>
<span id="cb17-348"><a href="#cb17-348" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Pérdida'</span>),</span>
<span id="cb17-349"><a href="#cb17-349" aria-hidden="true" tabindex="-1"></a>         <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb17-350"><a href="#cb17-350" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> iterations[<span class="fu">which.min</span>(loss_history_gd)],</span>
<span id="cb17-351"><a href="#cb17-351" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">min</span>(loss_history_gd),</span>
<span id="cb17-352"><a href="#cb17-352" aria-hidden="true" tabindex="-1"></a>           <span class="at">text =</span> <span class="fu">paste</span>(<span class="st">'Mínima pérdida:'</span>, <span class="fu">round</span>(<span class="fu">min</span>(loss_history_gd), <span class="dv">2</span>)),</span>
<span id="cb17-353"><a href="#cb17-353" aria-hidden="true" tabindex="-1"></a>           <span class="at">showarrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-354"><a href="#cb17-354" aria-hidden="true" tabindex="-1"></a>           <span class="at">arrowhead =</span> <span class="dv">7</span>,</span>
<span id="cb17-355"><a href="#cb17-355" aria-hidden="true" tabindex="-1"></a>           <span class="at">ax =</span> <span class="sc">-</span><span class="dv">40</span>,</span>
<span id="cb17-356"><a href="#cb17-356" aria-hidden="true" tabindex="-1"></a>           <span class="at">ay =</span> <span class="sc">-</span><span class="dv">40</span></span>
<span id="cb17-357"><a href="#cb17-357" aria-hidden="true" tabindex="-1"></a>         ))</span>
<span id="cb17-358"><a href="#cb17-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-359"><a href="#cb17-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-360"><a href="#cb17-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-361"><a href="#cb17-361" aria-hidden="true" tabindex="-1"></a>En el gráfico anterior, hemos agregado puntos en cada paso (iteración) para visualizar mejor cómo disminuye la pérdida a lo largo de las iteraciones. También hemos incluido una anotación que indica la pérdida mínima alcanzada.</span>
<span id="cb17-362"><a href="#cb17-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-363"><a href="#cb17-363" aria-hidden="true" tabindex="-1"></a>Visualizamos la evolución de los parámetros:</span>
<span id="cb17-364"><a href="#cb17-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-367"><a href="#cb17-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-368"><a href="#cb17-368" aria-hidden="true" tabindex="-1"></a>df_params_gd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-369"><a href="#cb17-369" aria-hidden="true" tabindex="-1"></a>  Iteración <span class="ot">=</span> iterations,</span>
<span id="cb17-370"><a href="#cb17-370" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mu =</span> mu_history_gd,</span>
<span id="cb17-371"><a href="#cb17-371" aria-hidden="true" tabindex="-1"></a>  <span class="at">Alpha =</span> alpha_history_gd</span>
<span id="cb17-372"><a href="#cb17-372" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-373"><a href="#cb17-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-374"><a href="#cb17-374" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de Mu</span></span>
<span id="cb17-375"><a href="#cb17-375" aria-hidden="true" tabindex="-1"></a>plot_mu <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(df_params_gd, <span class="at">x =</span> <span class="sc">~</span>Iteración, <span class="at">y =</span> <span class="sc">~</span>Mu, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, <span class="at">name =</span> <span class="st">'Mu'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-376"><a href="#cb17-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Evolución de Mu con Gradiente Descendente'</span>,</span>
<span id="cb17-377"><a href="#cb17-377" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Iteración'</span>),</span>
<span id="cb17-378"><a href="#cb17-378" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Mu'</span>))</span>
<span id="cb17-379"><a href="#cb17-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-380"><a href="#cb17-380" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de Alpha</span></span>
<span id="cb17-381"><a href="#cb17-381" aria-hidden="true" tabindex="-1"></a>plot_alpha <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(df_params_gd, <span class="at">x =</span> <span class="sc">~</span>Iteración, <span class="at">y =</span> <span class="sc">~</span>Alpha, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, <span class="at">name =</span> <span class="st">'Alpha'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-382"><a href="#cb17-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Evolución de Alpha con Gradiente Descendente'</span>,</span>
<span id="cb17-383"><a href="#cb17-383" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Iteración'</span>),</span>
<span id="cb17-384"><a href="#cb17-384" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Alpha'</span>))</span>
<span id="cb17-385"><a href="#cb17-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-386"><a href="#cb17-386" aria-hidden="true" tabindex="-1"></a><span class="fu">subplot</span>(plot_mu, plot_alpha, <span class="at">nrows =</span> <span class="dv">2</span>, <span class="at">shareX =</span> <span class="cn">TRUE</span>, <span class="at">titleX =</span> <span class="cn">TRUE</span>, <span class="at">titleY =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-387"><a href="#cb17-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Evolución de los Parámetros con Gradiente Descendente'</span>)</span>
<span id="cb17-388"><a href="#cb17-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-389"><a href="#cb17-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-390"><a href="#cb17-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-391"><a href="#cb17-391" aria-hidden="true" tabindex="-1"></a>En los gráficos anteriores, hemos colocado los gráficos de los parámetros $\mu$ y $\alpha$ uno debajo del otro para facilitar su visualización individual y apreciar cómo evolucionan a lo largo de las iteraciones.</span>
<span id="cb17-392"><a href="#cb17-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-393"><a href="#cb17-393" aria-hidden="true" tabindex="-1"></a>Para visualizar la trayectoria del gradiente descendente en el espacio de parámetros, podemos graficar la función de pérdida en función de los parámetros y superponer los pasos del algoritmo.</span>
<span id="cb17-394"><a href="#cb17-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-395"><a href="#cb17-395" aria-hidden="true" tabindex="-1"></a>Primero, generamos una cuadrícula de valores de $\mu$ y $\alpha$ y calculamos la pérdida asociada:</span>
<span id="cb17-396"><a href="#cb17-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-399"><a href="#cb17-399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-400"><a href="#cb17-400" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear una cuadrícula de valores para mu y alpha</span></span>
<span id="cb17-401"><a href="#cb17-401" aria-hidden="true" tabindex="-1"></a>mu_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(mu_history_gd), <span class="fu">max</span>(mu_history_gd), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb17-402"><a href="#cb17-402" aria-hidden="true" tabindex="-1"></a>alpha_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(alpha_history_gd), <span class="fu">max</span>(alpha_history_gd), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb17-403"><a href="#cb17-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-404"><a href="#cb17-404" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear una matriz para almacenar la pérdida</span></span>
<span id="cb17-405"><a href="#cb17-405" aria-hidden="true" tabindex="-1"></a>loss_grid <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(mu_seq), <span class="at">ncol =</span> <span class="fu">length</span>(alpha_seq))</span>
<span id="cb17-406"><a href="#cb17-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-407"><a href="#cb17-407" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mu_seq)) {</span>
<span id="cb17-408"><a href="#cb17-408" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(alpha_seq)) {</span>
<span id="cb17-409"><a href="#cb17-409" aria-hidden="true" tabindex="-1"></a>    preds <span class="ot">&lt;-</span> mu_seq[i] <span class="sc">+</span> alpha_seq[j] <span class="sc">*</span> data<span class="sc">$</span>Sup</span>
<span id="cb17-410"><a href="#cb17-410" aria-hidden="true" tabindex="-1"></a>    loss_grid[i, j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((data<span class="sc">$</span>Precio <span class="sc">-</span> preds)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-411"><a href="#cb17-411" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-412"><a href="#cb17-412" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-413"><a href="#cb17-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-414"><a href="#cb17-414" aria-hidden="true" tabindex="-1"></a><span class="co"># Transponer la matriz para que coincida con los ejes</span></span>
<span id="cb17-415"><a href="#cb17-415" aria-hidden="true" tabindex="-1"></a>loss_grid <span class="ot">&lt;-</span> <span class="fu">t</span>(loss_grid)</span>
<span id="cb17-416"><a href="#cb17-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-417"><a href="#cb17-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-418"><a href="#cb17-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-419"><a href="#cb17-419" aria-hidden="true" tabindex="-1"></a>Los valores finales obtenidos son:</span>
<span id="cb17-420"><a href="#cb17-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-421"><a href="#cb17-421" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\mu =$ <span class="in">`r round(mu_gd, 2)`</span></span>
<span id="cb17-422"><a href="#cb17-422" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\alpha =$ <span class="in">`r round(alpha_gd, 2)`</span></span>
<span id="cb17-423"><a href="#cb17-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-424"><a href="#cb17-424" aria-hidden="true" tabindex="-1"></a><span class="fu">## Resultados</span></span>
<span id="cb17-425"><a href="#cb17-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-426"><a href="#cb17-426" aria-hidden="true" tabindex="-1"></a>Comparando los resultados obtenidos con ambos métodos, observamos que convergen a valores similares. Para validar el modelo, podemos comparar las predicciones con los valores reales.</span>
<span id="cb17-427"><a href="#cb17-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-430"><a href="#cb17-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-431"><a href="#cb17-431" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones con los parámetros finales</span></span>
<span id="cb17-432"><a href="#cb17-432" aria-hidden="true" tabindex="-1"></a>preds_lj <span class="ot">&lt;-</span> mu_lj <span class="sc">+</span> alpha_lj <span class="sc">*</span> data<span class="sc">$</span>Sup</span>
<span id="cb17-433"><a href="#cb17-433" aria-hidden="true" tabindex="-1"></a>preds_gd <span class="ot">&lt;-</span> mu_gd <span class="sc">+</span> alpha_gd <span class="sc">*</span> data<span class="sc">$</span>Sup</span>
<span id="cb17-434"><a href="#cb17-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-435"><a href="#cb17-435" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de comparación</span></span>
<span id="cb17-436"><a href="#cb17-436" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(data, <span class="at">x =</span> <span class="sc">~</span>Sup, <span class="at">y =</span> <span class="sc">~</span>Precio, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'markers'</span>, <span class="at">name =</span> <span class="st">'Datos Reales'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-437"><a href="#cb17-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>Sup, <span class="at">y =</span> preds_lj, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Luus-Jaakola'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-438"><a href="#cb17-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>Sup, <span class="at">y =</span> preds_gd, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Gradiente Descendente'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-439"><a href="#cb17-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Ajuste del Modelo Lineal'</span>,</span>
<span id="cb17-440"><a href="#cb17-440" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Superficie Cubierta (Sup)'</span>),</span>
<span id="cb17-441"><a href="#cb17-441" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Precio'</span>))</span>
<span id="cb17-442"><a href="#cb17-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-443"><a href="#cb17-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-444"><a href="#cb17-444" aria-hidden="true" tabindex="-1"></a>Podemos observar que el modelo lineal ajusta razonablemente bien los datos, capturando la tendencia general de incremento del precio con la superficie cubierta.</span>
<span id="cb17-445"><a href="#cb17-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-446"><a href="#cb17-446" aria-hidden="true" tabindex="-1"></a>Para validar y contrastar nuestros resultados, utilizaremos la función nativa lm() de R para ajustar un modelo lineal y comparar los coeficientes obtenidos.</span>
<span id="cb17-447"><a href="#cb17-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-448"><a href="#cb17-448" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ajuste del Modelo Lineal con lm()</span></span>
<span id="cb17-449"><a href="#cb17-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-450"><a href="#cb17-450" aria-hidden="true" tabindex="-1"></a>La función lm() en R realiza un ajuste de mínimos cuadrados ordinarios (OLS), proporcionando una solución analítica al problema de regresión lineal.</span>
<span id="cb17-451"><a href="#cb17-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-454"><a href="#cb17-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-455"><a href="#cb17-455" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste del modelo lineal utilizando lm()</span></span>
<span id="cb17-456"><a href="#cb17-456" aria-hidden="true" tabindex="-1"></a>modelo_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Precio <span class="sc">~</span> Sup, <span class="at">data =</span> data)</span>
<span id="cb17-457"><a href="#cb17-457" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_lm)</span>
<span id="cb17-458"><a href="#cb17-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-459"><a href="#cb17-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-460"><a href="#cb17-460" aria-hidden="true" tabindex="-1"></a>El resumen del modelo proporciona los coeficientes estimados:</span>
<span id="cb17-461"><a href="#cb17-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-462"><a href="#cb17-462" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\mu =$ <span class="in">`r round(coef(modelo_lm)[1], 2)`</span></span>
<span id="cb17-463"><a href="#cb17-463" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\alpha =$ <span class="in">`r round(coef(modelo_lm)[2], 2)`</span></span>
<span id="cb17-464"><a href="#cb17-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-465"><a href="#cb17-465" aria-hidden="true" tabindex="-1"></a>Los valores son:</span>
<span id="cb17-466"><a href="#cb17-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-469"><a href="#cb17-469" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-470"><a href="#cb17-470" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtener los coeficientes del modelo lm</span></span>
<span id="cb17-471"><a href="#cb17-471" aria-hidden="true" tabindex="-1"></a>mu_lm <span class="ot">&lt;-</span> modelo_lm<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb17-472"><a href="#cb17-472" aria-hidden="true" tabindex="-1"></a>alpha_lm <span class="ot">&lt;-</span> modelo_lm<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb17-473"><a href="#cb17-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-474"><a href="#cb17-474" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un data frame con los valores</span></span>
<span id="cb17-475"><a href="#cb17-475" aria-hidden="true" tabindex="-1"></a>coeficientes_lm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-476"><a href="#cb17-476" aria-hidden="true" tabindex="-1"></a>  Parámetro <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Mu"</span>, <span class="st">"Alpha"</span>),</span>
<span id="cb17-477"><a href="#cb17-477" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valor =</span> <span class="fu">c</span>(<span class="fu">round</span>(mu_lm, <span class="dv">2</span>), <span class="fu">round</span>(alpha_lm, <span class="dv">2</span>))</span>
<span id="cb17-478"><a href="#cb17-478" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-479"><a href="#cb17-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-480"><a href="#cb17-480" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar la tabla usando knitr::kable</span></span>
<span id="cb17-481"><a href="#cb17-481" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb17-482"><a href="#cb17-482" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(coeficientes_lm, <span class="at">caption =</span> <span class="st">"Valores obtenidos con lm()"</span>)</span>
<span id="cb17-483"><a href="#cb17-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-484"><a href="#cb17-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-485"><a href="#cb17-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-486"><a href="#cb17-486" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comparación de Predicciones</span></span>
<span id="cb17-487"><a href="#cb17-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-488"><a href="#cb17-488" aria-hidden="true" tabindex="-1"></a>Para visualizar el ajuste de los modelos, graficamos las predicciones obtenidas con cada método junto con los datos reales:</span>
<span id="cb17-489"><a href="#cb17-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-492"><a href="#cb17-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-493"><a href="#cb17-493" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones con los parámetros finales</span></span>
<span id="cb17-494"><a href="#cb17-494" aria-hidden="true" tabindex="-1"></a>preds_lj <span class="ot">&lt;-</span> mu_lj <span class="sc">+</span> alpha_lj <span class="sc">*</span> data<span class="sc">$</span>Sup</span>
<span id="cb17-495"><a href="#cb17-495" aria-hidden="true" tabindex="-1"></a>preds_gd <span class="ot">&lt;-</span> mu_gd <span class="sc">+</span> alpha_gd <span class="sc">*</span> data<span class="sc">$</span>Sup</span>
<span id="cb17-496"><a href="#cb17-496" aria-hidden="true" tabindex="-1"></a>preds_lm <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_lm, data)</span>
<span id="cb17-497"><a href="#cb17-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-498"><a href="#cb17-498" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de comparación</span></span>
<span id="cb17-499"><a href="#cb17-499" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(data, <span class="at">x =</span> <span class="sc">~</span>Sup, <span class="at">y =</span> <span class="sc">~</span>Precio, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'markers'</span>, <span class="at">name =</span> <span class="st">'Datos Reales'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-500"><a href="#cb17-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>Sup, <span class="at">y =</span> preds_lj, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Luus-Jaakola'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'red'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-501"><a href="#cb17-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>Sup, <span class="at">y =</span> preds_gd, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Gradiente Descendente'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'green'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-502"><a href="#cb17-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>Sup, <span class="at">y =</span> preds_lm, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'lm()'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'blue'</span>, <span class="at">dash =</span> <span class="st">'dash'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-503"><a href="#cb17-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Ajuste del Modelo Lineal con Diferentes Métodos'</span>,</span>
<span id="cb17-504"><a href="#cb17-504" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Superficie Cubierta (Sup)'</span>),</span>
<span id="cb17-505"><a href="#cb17-505" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Precio'</span>),</span>
<span id="cb17-506"><a href="#cb17-506" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fl">0.1</span>, <span class="at">y =</span> <span class="fl">0.9</span>))</span>
<span id="cb17-507"><a href="#cb17-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-508"><a href="#cb17-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-509"><a href="#cb17-509" aria-hidden="true" tabindex="-1"></a>&lt;br&gt; Como las tres líneas prácticamente se superponen, indican que todos los métodos proporcionan un ajuste muy similar. Destacamos que el método LM() y la optimización por gradiente descendente llegaron a exactamente el mismo resultado.</span>
<span id="cb17-510"><a href="#cb17-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-511"><a href="#cb17-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb17-512"><a href="#cb17-512" aria-hidden="true" tabindex="-1"></a><span class="in"># Calcular los MSE</span></span>
<span id="cb17-513"><a href="#cb17-513" aria-hidden="true" tabindex="-1"></a><span class="in">mse_lj &lt;- mean((data$Precio - preds_lj)^2)</span></span>
<span id="cb17-514"><a href="#cb17-514" aria-hidden="true" tabindex="-1"></a><span class="in">mse_gd &lt;- mean((data$Precio - preds_gd)^2)</span></span>
<span id="cb17-515"><a href="#cb17-515" aria-hidden="true" tabindex="-1"></a><span class="in">mse_lm &lt;- mean((data$Precio - preds_lm)^2)</span></span>
<span id="cb17-516"><a href="#cb17-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-517"><a href="#cb17-517" aria-hidden="true" tabindex="-1"></a><span class="in"># Crear un data frame con los coeficientes obtenidos</span></span>
<span id="cb17-518"><a href="#cb17-518" aria-hidden="true" tabindex="-1"></a><span class="in">coeficientes &lt;- data.frame(</span></span>
<span id="cb17-519"><a href="#cb17-519" aria-hidden="true" tabindex="-1"></a><span class="in">  Método = c("Luus-Jaakola", "Gradiente Descendente", "lm()"),</span></span>
<span id="cb17-520"><a href="#cb17-520" aria-hidden="true" tabindex="-1"></a><span class="in">  Mu = c(round(mu_lj, 2), round(mu_gd, 2), round(mu_lm, 2)),</span></span>
<span id="cb17-521"><a href="#cb17-521" aria-hidden="true" tabindex="-1"></a><span class="in">  Alpha = c(round(alpha_lj, 2), round(alpha_gd, 2), round(alpha_lm, 2)),</span></span>
<span id="cb17-522"><a href="#cb17-522" aria-hidden="true" tabindex="-1"></a><span class="in">  MSE = c(round(mse_lj, 2), round(mse_gd, 2), round(mse_lm, 2))</span></span>
<span id="cb17-523"><a href="#cb17-523" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb17-524"><a href="#cb17-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-525"><a href="#cb17-525" aria-hidden="true" tabindex="-1"></a><span class="in"># Mostrar la tabla utilizando kable</span></span>
<span id="cb17-526"><a href="#cb17-526" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::kable(coeficientes, caption = "Comparación de coeficientes obtenidos con diferentes métodos")</span></span>
<span id="cb17-527"><a href="#cb17-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-528"><a href="#cb17-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-529"><a href="#cb17-529" aria-hidden="true" tabindex="-1"></a>&lt;br&gt; Podemos observar que los valores obtenidos con nuestros métodos de optimización numérica son muy cercanos a los obtenidos con la solución analítica de **lm()**, lo que valida la eficacia de los algoritmos implementados.</span>
<span id="cb17-530"><a href="#cb17-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-531"><a href="#cb17-531" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusiones</span></span>
<span id="cb17-532"><a href="#cb17-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-533"><a href="#cb17-533" aria-hidden="true" tabindex="-1"></a>En este trabajo, hemos aplicado modelos lineales y algoritmos de optimización para predecir el precio de venta de casas en el barrio de Boedo, en base a la superficie cubierta.</span>
<span id="cb17-534"><a href="#cb17-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-535"><a href="#cb17-535" aria-hidden="true" tabindex="-1"></a>Utilizamos dos métodos de optimización: **Luus-Jaakola** y **gradiente descendente**. Ambos métodos convergieron a soluciones similares, confirmando la efectividad de estos algoritmos en la optimización de funciones convexas.</span>
<span id="cb17-536"><a href="#cb17-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-537"><a href="#cb17-537" aria-hidden="true" tabindex="-1"></a>El modelo lineal simple utilizado demostró ser adecuado para capturar la relación entre la superficie cubierta y el precio. Sin embargo, para mejorar el modelo, podríamos considerar incluir otras variables, como el fondo, la cantidad de habitaciones, o características del barrio.</span>
<span id="cb17-538"><a href="#cb17-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-539"><a href="#cb17-539" aria-hidden="true" tabindex="-1"></a><span class="fu">## Apendice</span></span>
<span id="cb17-540"><a href="#cb17-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-541"><a href="#cb17-541" aria-hidden="true" tabindex="-1"></a>Bibliografia</span>
<span id="cb17-542"><a href="#cb17-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-543"><a href="#cb17-543" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">\[1\]</span><span class="co">](https://www.properati.com.ar/)</span> Properati, Sitio Web de Properati</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="finalv2_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>